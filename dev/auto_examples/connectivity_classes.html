
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Using the connectivity classes &#8212; MNE-Connectivity 0.3dev0 documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
    <!-- add `style` or `link` tags with your CSS `@font-face` declarations here -->
    <!-- ... and a `style` tag with setting `font-family` in `body` and `.header-style` -->
    <!-- ... and optionally preload the `woff2` for snappier page loads -->
    <!-- or add a `style` tag with a font fallback chain with good cross-platform coverage -->
    <style>
        body,.header-style {font-family: 'Source Sans Pro', sans-serif;}
        code,kbd,pre,samp {font-family: 'Source Code Pro', monospace;}
    </style>

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Compute vector autoregressive model (linear system)" href="dynamic/mne_var_connectivity.html" />
    <link rel="prev" title="Compute source space connectivity and visualize it using a circular graph" href="mne_inverse_label_connectivity.html" />
    <link rel="canonical" href="https://mne.tools/mne-connectivity/stable/index.html" />
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/scrollfix.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">MNE-Connectivity</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../whats_new.html">
  What’s new?
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../install.html">
  Installation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  Examples
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown">
        v0.3dev0
        <span class="caret"></span>
    </button>
    <div class="dropdown-menu list-group-flush py-0" aria-labelledby="dLabelMore">
        <a class="list-group-item list-group-item-action py-1" href="https://mne.tools/mne-connectivity/dev/index.html">v0.3 (devel)</a>
        <a class="list-group-item list-group-item-action py-1" href="https://mne.tools/mne-connectivity/stable/index.html">v0.2 (stable)</a>
        <a class="list-group-item list-group-item-action py-1" href="https://mne.tools/mne-connectivity/v0.1/index.html">v0.1</a>
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/mne-tools/mne-connectivity" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mne_inverse_psi_visual.html">
   Compute Phase Slope Index (PSI) in source space for a visual stimulus
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="sensor_connectivity.html">
   Compute all-to-all connectivity in sensor space
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mne_inverse_coherence_epochs.html">
   Compute coherence in source space using a MNE inverse solution
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mne_inverse_envelope_correlation.html">
   Compute envelope correlations in source space
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mne_inverse_envelope_correlation_volume.html">
   Compute envelope correlations in volume source space
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mne_inverse_connectivity_spectrum.html">
   Compute full spectrum source space connectivity between labels
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mixed_source_space_connectivity.html">
   Compute mixed source space connectivity and visualize it using a circular graph
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cwt_sensor_connectivity.html">
   Compute seed-based time-frequency connectivity in sensor space
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="mne_inverse_label_connectivity.html">
   Compute source space connectivity and visualize it using a circular graph
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Using the connectivity classes
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="dynamic/mne_var_connectivity.html">
   Compute vector autoregressive model (linear system)
  </a>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-connectivity-classes-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="using-the-connectivity-classes">
<span id="ex-connectivity-measures"></span><span id="sphx-glr-auto-examples-connectivity-classes-py"></span><h1>Using the connectivity classes<a class="headerlink" href="#using-the-connectivity-classes" title="Permalink to this headline">¶</a></h1>
<p>Compute different connectivity measures and then demonstrate
the utility of the class.</p>
<p>Here we compute the Phase Lag Index (PLI) between all gradiometers and showcase
how we can interact with the connectivity class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Adam Li &lt;adam2392@gmail.com&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">mne</span>
<span class="kn">from</span> <span class="nn">mne_connectivity</span> <span class="kn">import</span> <a href="../generated/mne_connectivity.spectral_connectivity.html#mne_connectivity.spectral_connectivity" title="mne_connectivity.spectral_connectivity" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-function"><span class="n">spectral_connectivity</span></a>
<span class="kn">from</span> <span class="nn">mne.datasets</span> <span class="kn">import</span> <span class="n">sample</span>
</pre></div>
</div>
<p>Set parameters</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path" title="mne.datasets.sample.data_path" class="sphx-glr-backref-module-mne-datasets-sample sphx-glr-backref-type-py-function"><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/sample_audvis_filt-0-40_raw.fif&#39;</span>
<a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">+</span> <span class="s1">&#39;/MEG/sample/sample_audvis_filt-0-40_raw-eve.fif&#39;</span>

<span class="c1"># Setup for reading the raw data</span>
<a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.read_events.html#mne.read_events" title="mne.read_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_events</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_fname</span></a><span class="p">)</span>

<span class="c1"># Add a bad channel</span>
<a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;bads&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;MEG 2443&#39;</span><span class="p">]</span>

<span class="c1"># Pick MEG gradiometers</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.pick_types.html#mne.pick_types" title="mne.pick_types" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">exclude</span><span class="o">=</span><span class="s1">&#39;bads&#39;</span><span class="p">)</span>

<span class="c1"># Create epochs for the visual condition</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.5</span>  <span class="c1"># need a long enough epoch for 5 cycles</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span><a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="p">,</span>
                    <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">reject</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">grad</span><span class="o">=</span><span class="mf">4000e-13</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="mf">150e-6</span><span class="p">))</span>

<span class="c1"># Compute connectivity for the alpha band that contains the evoked response</span>
<span class="c1"># (4-9 Hz). We exclude the baseline period:</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a> <span class="o">=</span> <span class="mf">4.</span><span class="p">,</span> <span class="mf">9.</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cwt_freqs</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne.Info" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s1">&#39;sfreq&#39;</span><span class="p">]</span>  <span class="c1"># the sampling frequency</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># exclude the baseline period</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs.load_data" title="mne.Epochs.load_data" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">load_data</span></a><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">meg</span><span class="o">=</span><span class="s1">&#39;grad&#39;</span><span class="p">)</span>  <span class="c1"># just keep MEG and no EOG now</span>
<a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity" title="mne_connectivity.SpectroTemporalConnectivity" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">con</span></a> <span class="o">=</span> <a href="../generated/mne_connectivity.spectral_connectivity.html#mne_connectivity.spectral_connectivity" title="mne_connectivity.spectral_connectivity" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-function"><span class="n">spectral_connectivity</span></a><span class="p">(</span>
    <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;pli&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;cwt_morlet&#39;</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="p">,</span>
    <span class="n">faverage</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cwt_freqs</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">cwt_freqs</span></a><span class="p">,</span> <span class="n">mt_adaptive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/mne_data/MNE-sample-data/MEG/sample/sample_audvis_filt-0-40_raw.fif...
    Read a total of 4 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
        Average EEG reference (1 x 60)  idle
    Range : 6450 ... 48149 =     42.956 ...   320.665 secs
Ready.
Not setting metadata
Not setting metadata
73 matching events found
Setting baseline interval to [-0.19979521315838786, 0.0] sec
Applying baseline correction (mode: mean)
4 projection items activated
Loading data for 73 events and 256 original time points ...
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
24 bad epochs dropped
Removing projector &lt;Projection | PCA-v1, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v2, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | PCA-v3, active : True, n_channels : 102&gt;
Removing projector &lt;Projection | Average EEG reference, active : True, n_channels : 60&gt;
Connectivity computation...
only using indices for lower-triangular matrix
    computing connectivity for 20503 connections
    using t=0.000s..1.498s for estimation (226 points)
    frequencies: 4.0Hz..9.0Hz (20 points)
    using CWT with Morlet wavelets to estimate spectra
    the following metrics will be computed: PLI
    computing connectivity for epoch 1
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 2
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 3
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 4
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 5
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 6
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 7
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 8
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 9
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 10
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 11
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 12
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 13
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 14
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 15
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 16
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 17
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 18
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 19
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 20
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 21
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 22
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 23
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 24
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 25
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 26
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 27
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 28
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 29
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 30
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 31
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 32
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 33
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 34
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 35
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 36
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 37
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 38
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 39
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 40
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 41
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 42
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 43
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 44
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 45
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 46
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 47
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 48
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    computing connectivity for epoch 49
/home/circleci/project/mne_connectivity/spectral.py:396: UserWarning: At least one of the wavelets (419) is longer than the signal (226). Consider using a longer signal or shorter wavelets.
  this_x_t = cwt(this_data[sig_idx, tmin_idx:tmax_idx],
    assembling connectivity matrix
[Connectivity computation done]
</pre></div>
</div>
<p>Now, we can look at different functionalities of the connectivity
class returned by <a class="reference internal" href="../generated/mne_connectivity.spectral_connectivity.html#mne_connectivity.spectral_connectivity" title="mne_connectivity.spectral_connectivity"><code class="xref py py-func docutils literal notranslate"><span class="pre">mne_connectivity.spectral_connectivity()</span></code></a>. The
following are some basic attributes of connectivity classes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the dimensions of the data corresponding to each axis</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.dims" title="mne_connectivity.SpectroTemporalConnectivity.dims" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">dims</span></a><span class="p">)</span>

<span class="c1"># the coordinates for each axis of the data</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.coords" title="mne_connectivity.SpectroTemporalConnectivity.coords" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">coords</span></a><span class="p">)</span>

<span class="c1"># the number of nodes matches the number of electrodes used to compute the</span>
<span class="c1"># spectral measure</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.n_nodes" title="mne_connectivity.SpectroTemporalConnectivity.n_nodes" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">n_nodes</span></a><span class="p">)</span>

<span class="c1"># the names of each node correspond to the electrode names</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.names" title="mne_connectivity.SpectroTemporalConnectivity.names" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">names</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(&#39;node_in -&gt; node_out&#39;, &#39;freqs&#39;, &#39;times&#39;)
Coordinates:
  * node_in -&gt; node_out  (node_in -&gt; node_out) &lt;U5 &#39;0&#39; &#39;1&#39; ... &#39;41207&#39; &#39;41208&#39;
  * freqs                (freqs) float64 4.0 4.263 4.526 ... 8.474 8.737 9.0
  * times                (times) float64 0.0 0.00666 0.01332 ... 1.492 1.498
203
[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;10&#39;, &#39;11&#39;, &#39;12&#39;, &#39;13&#39;, &#39;14&#39;, &#39;15&#39;, &#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;, &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;, &#39;32&#39;, &#39;33&#39;, &#39;34&#39;, &#39;35&#39;, &#39;36&#39;, &#39;37&#39;, &#39;38&#39;, &#39;39&#39;, &#39;40&#39;, &#39;41&#39;, &#39;42&#39;, &#39;43&#39;, &#39;44&#39;, &#39;45&#39;, &#39;46&#39;, &#39;47&#39;, &#39;48&#39;, &#39;49&#39;, &#39;50&#39;, &#39;51&#39;, &#39;52&#39;, &#39;53&#39;, &#39;54&#39;, &#39;55&#39;, &#39;56&#39;, &#39;57&#39;, &#39;58&#39;, &#39;59&#39;, &#39;60&#39;, &#39;61&#39;, &#39;62&#39;, &#39;63&#39;, &#39;64&#39;, &#39;65&#39;, &#39;66&#39;, &#39;67&#39;, &#39;68&#39;, &#39;69&#39;, &#39;70&#39;, &#39;71&#39;, &#39;72&#39;, &#39;73&#39;, &#39;74&#39;, &#39;75&#39;, &#39;76&#39;, &#39;77&#39;, &#39;78&#39;, &#39;79&#39;, &#39;80&#39;, &#39;81&#39;, &#39;82&#39;, &#39;83&#39;, &#39;84&#39;, &#39;85&#39;, &#39;86&#39;, &#39;87&#39;, &#39;88&#39;, &#39;89&#39;, &#39;90&#39;, &#39;91&#39;, &#39;92&#39;, &#39;93&#39;, &#39;94&#39;, &#39;95&#39;, &#39;96&#39;, &#39;97&#39;, &#39;98&#39;, &#39;99&#39;, &#39;100&#39;, &#39;101&#39;, &#39;102&#39;, &#39;103&#39;, &#39;104&#39;, &#39;105&#39;, &#39;106&#39;, &#39;107&#39;, &#39;108&#39;, &#39;109&#39;, &#39;110&#39;, &#39;111&#39;, &#39;112&#39;, &#39;113&#39;, &#39;114&#39;, &#39;115&#39;, &#39;116&#39;, &#39;117&#39;, &#39;118&#39;, &#39;119&#39;, &#39;120&#39;, &#39;121&#39;, &#39;122&#39;, &#39;123&#39;, &#39;124&#39;, &#39;125&#39;, &#39;126&#39;, &#39;127&#39;, &#39;128&#39;, &#39;129&#39;, &#39;130&#39;, &#39;131&#39;, &#39;132&#39;, &#39;133&#39;, &#39;134&#39;, &#39;135&#39;, &#39;136&#39;, &#39;137&#39;, &#39;138&#39;, &#39;139&#39;, &#39;140&#39;, &#39;141&#39;, &#39;142&#39;, &#39;143&#39;, &#39;144&#39;, &#39;145&#39;, &#39;146&#39;, &#39;147&#39;, &#39;148&#39;, &#39;149&#39;, &#39;150&#39;, &#39;151&#39;, &#39;152&#39;, &#39;153&#39;, &#39;154&#39;, &#39;155&#39;, &#39;156&#39;, &#39;157&#39;, &#39;158&#39;, &#39;159&#39;, &#39;160&#39;, &#39;161&#39;, &#39;162&#39;, &#39;163&#39;, &#39;164&#39;, &#39;165&#39;, &#39;166&#39;, &#39;167&#39;, &#39;168&#39;, &#39;169&#39;, &#39;170&#39;, &#39;171&#39;, &#39;172&#39;, &#39;173&#39;, &#39;174&#39;, &#39;175&#39;, &#39;176&#39;, &#39;177&#39;, &#39;178&#39;, &#39;179&#39;, &#39;180&#39;, &#39;181&#39;, &#39;182&#39;, &#39;183&#39;, &#39;184&#39;, &#39;185&#39;, &#39;186&#39;, &#39;187&#39;, &#39;188&#39;, &#39;189&#39;, &#39;190&#39;, &#39;191&#39;, &#39;192&#39;, &#39;193&#39;, &#39;194&#39;, &#39;195&#39;, &#39;196&#39;, &#39;197&#39;, &#39;198&#39;, &#39;199&#39;, &#39;200&#39;, &#39;201&#39;, &#39;202&#39;]
</pre></div>
</div>
<p>The underlying connectivity measure can be stored in two ways: i) raveled
and ii) dense. Raveled storage will be a 1D column flattened array, similar
to what one might expect when using <a class="reference external" href="https://numpy.org/devdocs/reference/generated/numpy.ravel.html#numpy.ravel" title="(in NumPy v1.22.dev0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ravel</span></code></a>. However, if you ask for
the dense data, then the shape will show the N by N connectivity.
In general, you might prefer the raveled version if you specify a subset of
indices (e.g. some subset of sources) for the computation
of a bivariate connectivity measure or if you have a symmetric measure
(e.g. coherence). The ‘dense’ output on the other hand provides an actual
square matrix, which can be used for post-hoc analysis that expects a matrix
shape.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># the underlying data is stored &quot;raveled&quot;, and the connectivity measure is</span>
<span class="c1"># flattened into one dimension</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.shape" title="mne_connectivity.SpectroTemporalConnectivity.shape" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">shape</span></a><span class="p">)</span>

<span class="c1"># the &#39;dense&#39; output will show the connectivity measure&#39;s N x N axis</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.get_data" title="mne_connectivity.SpectroTemporalConnectivity.get_data" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-method"><span class="n">con</span><span class="o">.</span><span class="n">get_data</span></a><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;dense&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(41209, 20, 226)
(203, 203, 20, 226)
</pre></div>
</div>
<p>The underlying data is stored as an xarray, so we have access
to DataArray attributes. Each connectivity measure function automatically
stores relevant metadata. For example, the method used in this example
is the phase-lag index (‘pli’).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.attrs" title="mne_connectivity.SpectroTemporalConnectivity.attrs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span></a><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.attrs" title="mne_connectivity.SpectroTemporalConnectivity.attrs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">get</span></a><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">))</span>

<span class="c1"># You can also store additional metadata relevant to your experiment, which can</span>
<span class="c1"># easily be done, because ``attrs`` is just a dictionary.</span>
<a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.attrs" title="mne_connectivity.SpectroTemporalConnectivity.attrs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">attrs</span></a><span class="p">[</span><span class="s1">&#39;experimenter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;mne&#39;</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.attrs" title="mne_connectivity.SpectroTemporalConnectivity.attrs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span></a><span class="p">())</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;spec_method&#39;, &#39;n_epochs_used&#39;, &#39;freqs_used&#39;, &#39;times_used&#39;, &#39;n_tapers&#39;, &#39;node_names&#39;, &#39;method&#39;, &#39;indices&#39;, &#39;n_nodes&#39;])
[&#39;pli&#39;]
dict_keys([&#39;spec_method&#39;, &#39;n_epochs_used&#39;, &#39;freqs_used&#39;, &#39;times_used&#39;, &#39;n_tapers&#39;, &#39;node_names&#39;, &#39;method&#39;, &#39;indices&#39;, &#39;n_nodes&#39;, &#39;experimenter&#39;])
</pre></div>
</div>
<p>Other properties of the connectivity class, special to
the spectro-temporal connectivity class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Not all connectivity classes will have these properties.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># a frequency axis shows the different frequencies used in estimating</span>
<span class="c1"># the spectral measure</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.freqs" title="mne_connectivity.SpectroTemporalConnectivity.freqs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">freqs</span></a><span class="p">)</span>

<span class="c1"># a time axis shows the different time points because the spectral</span>
<span class="c1"># measure is time-resolved</span>
<span class="nb">print</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectroTemporalConnectivity.html#mne_connectivity.SpectroTemporalConnectivity.times" title="mne_connectivity.SpectroTemporalConnectivity.times" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-property"><span class="n">con</span><span class="o">.</span><span class="n">times</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[4.0, 4.2631578947368425, 4.526315789473684, 4.7894736842105265, 5.052631578947368, 5.315789473684211, 5.578947368421053, 5.842105263157895, 6.105263157894736, 6.368421052631579, 6.631578947368421, 6.894736842105263, 7.157894736842105, 7.421052631578947, 7.684210526315789, 7.947368421052632, 8.210526315789473, 8.473684210526315, 8.736842105263158, 9.0]
[0.0, 0.006659840438612929, 0.013319680877225858, 0.019979521315838786, 0.026639361754451717, 0.03329920219306465, 0.03995904263167757, 0.0466188830702905, 0.05327872350890343, 0.05993856394751636, 0.0665984043861293, 0.07325824482474222, 0.07991808526335514, 0.08657792570196808, 0.093237766140581, 0.09989760657919393, 0.10655744701780687, 0.11321728745641979, 0.11987712789503271, 0.12653696833364564, 0.1331968087722586, 0.13985664921087151, 0.14651648964948444, 0.15317633008809736, 0.1598361705267103, 0.1664960109653232, 0.17315585140393616, 0.17981569184254909, 0.186475532281162, 0.19313537271977493, 0.19979521315838786, 0.20645505359700078, 0.21311489403561373, 0.21977473447422666, 0.22643457491283958, 0.2330944153514525, 0.23975425579006543, 0.24641409622867838, 0.2530739366672913, 0.25973377710590423, 0.2663936175445172, 0.2730534579831301, 0.27971329842174303, 0.2863731388603559, 0.2930329792989689, 0.2996928197375818, 0.3063526601761947, 0.3130125006148077, 0.3196723410534206, 0.3263321814920335, 0.3329920219306464, 0.33965186236925937, 0.3463117028078723, 0.3529715432464852, 0.35963138368509817, 0.36629122412371107, 0.372951064562324, 0.37961090500093697, 0.38627074543954987, 0.3929305858781628, 0.3995904263167757, 0.40625026675538867, 0.41291010719400156, 0.4195699476326145, 0.42622978807122747, 0.43288962850984036, 0.4395494689484533, 0.4462093093870662, 0.45286914982567916, 0.4595289902642921, 0.466188830702905, 0.47284867114151796, 0.47950851158013086, 0.4861683520187438, 0.49282819245735676, 0.49948803289596966, 0.5061478733345826, 0.5128077137731956, 0.5194675542118085, 0.5261273946504214, 0.5327872350890344, 0.5394470755276473, 0.5461069159662602, 0.552766756404873, 0.5594265968434861, 0.566086437282099, 0.5727462777207118, 0.5794061181593249, 0.5860659585979378, 0.5927257990365506, 0.5993856394751635, 0.6060454799137766, 0.6127053203523894, 0.6193651607910023, 0.6260250012296154, 0.6326848416682282, 0.6393446821068411, 0.6460045225454542, 0.652664362984067, 0.6593242034226799, 0.6659840438612928, 0.6726438842999058, 0.6793037247385187, 0.6859635651771316, 0.6926234056157446, 0.6992832460543575, 0.7059430864929704, 0.7126029269315833, 0.7192627673701963, 0.7259226078088092, 0.7325824482474221, 0.7392422886860351, 0.745902129124648, 0.7525619695632609, 0.7592218100018739, 0.7658816504404868, 0.7725414908790997, 0.7792013313177126, 0.7858611717563256, 0.7925210121949385, 0.7991808526335514, 0.8058406930721644, 0.8125005335107773, 0.8191603739493902, 0.8258202143880031, 0.8324800548266161, 0.839139895265229, 0.8457997357038419, 0.8524595761424549, 0.8591194165810678, 0.8657792570196807, 0.8724390974582937, 0.8790989378969066, 0.8857587783355195, 0.8924186187741324, 0.8990784592127454, 0.9057382996513583, 0.9123981400899712, 0.9190579805285842, 0.9257178209671971, 0.93237766140581, 0.939037501844423, 0.9456973422830359, 0.9523571827216488, 0.9590170231602617, 0.9656768635988747, 0.9723367040374876, 0.9789965444761005, 0.9856563849147135, 0.9923162253533264, 0.9989760657919393, 1.0056359062305522, 1.012295746669165, 1.0189555871077782, 1.0256154275463911, 1.032275267985004, 1.038935108423617, 1.0455949488622298, 1.0522547893008427, 1.0589146297394556, 1.0655744701780687, 1.0722343106166816, 1.0788941510552945, 1.0855539914939074, 1.0922138319325203, 1.0988736723711332, 1.105533512809746, 1.1121933532483592, 1.1188531936869721, 1.125513034125585, 1.132172874564198, 1.1388327150028108, 1.1454925554414237, 1.1521523958800366, 1.1588122363186497, 1.1654720767572626, 1.1721319171958755, 1.1787917576344884, 1.1854515980731013, 1.1921114385117142, 1.198771278950327, 1.2054311193889402, 1.212090959827553, 1.218750800266166, 1.225410640704779, 1.2320704811433918, 1.2387303215820047, 1.2453901620206178, 1.2520500024592307, 1.2587098428978436, 1.2653696833364565, 1.2720295237750694, 1.2786893642136823, 1.2853492046522952, 1.2920090450909083, 1.2986688855295212, 1.305328725968134, 1.311988566406747, 1.3186484068453599, 1.3253082472839728, 1.3319680877225857, 1.3386279281611988, 1.3452877685998117, 1.3519476090384246, 1.3586074494770375, 1.3652672899156504, 1.3719271303542633, 1.3785869707928762, 1.3852468112314893, 1.3919066516701022, 1.398566492108715, 1.405226332547328, 1.4118861729859409, 1.4185460134245538, 1.4252058538631667, 1.4318656943017798, 1.4385255347403927, 1.4451853751790056, 1.4518452156176185, 1.4585050560562314, 1.4651648964948443, 1.4718247369334574, 1.4784845773720703, 1.4851444178106832, 1.491804258249296, 1.498464098687909]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  33.970 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-connectivity-classes-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/980054063d6073a3d7942ac239432571/connectivity_classes.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">connectivity_classes.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/e3e768dadc6db0b74fd182648f25579e/connectivity_classes.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">connectivity_classes.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>


              </div>
              
              
              <div class='prev-next-bottom'>
                
    <a class='left-prev' id="prev-link" href="mne_inverse_label_connectivity.html" title="previous page">Compute source space connectivity and visualize it using a circular graph</a>
    <a class='right-next' id="next-link" href="dynamic/mne_var_connectivity.html" title="next page">Compute vector autoregressive model (linear system)</a>

              </div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021-2021, MNE Developers. Last updated on 2021-09-14.<br/>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br/>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>