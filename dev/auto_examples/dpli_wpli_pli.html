
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Comparing PLI, wPLI, and dPLI &#8212; MNE-Connectivity 0.8.0.dev84+g1e601007 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../_static/style.css?v=02ec7c47" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=7ec5c594"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=fd10adb8"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/dpli_wpli_pli';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://mne.tools/mne-connectivity/dev/_static/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Comparing spectral connectivity computed over time or over trials" href="compare_connectivity_over_time_over_trial.html" />
    <link rel="prev" title="Examples" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.8" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">MNE-Connectivity 0.8.0.dev84+g1e601007 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../whats_new.html">
    What’s new?
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mne-tools/mne-connectivity" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../whats_new.html">
    What’s new?
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../install.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api.html">
    API
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/mne-tools/mne-connectivity" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fab fa-github-square fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Comparing PLI, wPLI, and dPLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="compare_connectivity_over_time_over_trial.html">Comparing spectral connectivity computed over time or over trials</a></li>
<li class="toctree-l1"><a class="reference internal" href="compare_coherency_methods.html">Comparison of coherency-based methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="mne_inverse_psi_visual.html">Compute Phase Slope Index (PSI) in source space for a visual stimulus</a></li>
<li class="toctree-l1"><a class="reference internal" href="sensor_connectivity.html">Compute all-to-all connectivity in sensor space</a></li>
<li class="toctree-l1"><a class="reference internal" href="mne_inverse_coherence_epochs.html">Compute coherence in source space using a MNE inverse solution</a></li>
<li class="toctree-l1"><a class="reference internal" href="granger_causality.html">Compute directionality of connectivity with multivariate Granger causality</a></li>
<li class="toctree-l1"><a class="reference internal" href="mne_inverse_envelope_correlation.html">Compute envelope correlations in source space</a></li>
<li class="toctree-l1"><a class="reference internal" href="mne_inverse_envelope_correlation_volume.html">Compute envelope correlations in volume source space</a></li>
<li class="toctree-l1"><a class="reference internal" href="mne_inverse_connectivity_spectrum.html">Compute full spectrum source space connectivity between labels</a></li>
<li class="toctree-l1"><a class="reference internal" href="mixed_source_space_connectivity.html">Compute mixed source space connectivity and visualize it using a circular graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="cacoh.html">Compute multivariate coherency/coherence</a></li>
<li class="toctree-l1"><a class="reference internal" href="mic_mim.html">Compute multivariate measures of the imaginary part of coherency</a></li>
<li class="toctree-l1"><a class="reference internal" href="cwt_sensor_connectivity.html">Compute seed-based time-frequency connectivity in sensor space</a></li>
<li class="toctree-l1"><a class="reference internal" href="mne_inverse_label_connectivity.html">Compute source space connectivity and visualize it using a circular graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="surrogate_connectivity.html">Determine the significance of connectivity estimates against baseline connectivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="connectivity_classes.html">Using the connectivity classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="handling_ragged_arrays.html">Working with ragged indices for multivariate connectivity</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="decoding/index.html">Decoding &amp; Decomposition Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="decoding/cohy_decomposition.html">Multivariate decomposition for efficient connectivity analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="decoding/cohy_decomposition_plotting.html">Visualising spatial contributions to multivariate connectivity</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="dynamic/index.html">Dynamic Connectivity Examples</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="dynamic/mne_var_connectivity.html">Compute vector autoregressive model (linear system)</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Comparing PLI, wPLI, and dPLI</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-dpli-wpli-pli-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="comparing-pli-wpli-and-dpli">
<span id="sphx-glr-auto-examples-dpli-wpli-pli-py"></span><h1>Comparing PLI, wPLI, and dPLI<a class="headerlink" href="#comparing-pli-wpli-and-dpli" title="Link to this heading">#</a></h1>
<p>This example demonstrates the different connectivity information captured by
the phase lag index (PLI) <a class="footnote-reference brackets" href="#footcite-stametal2007" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, weighted phase lag index
(wPLI) <a class="footnote-reference brackets" href="#footcite-vincketal2011" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>, and directed phase lag index (dPLI)
<a class="footnote-reference brackets" href="#footcite-stametal2012" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> on simulated data.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Authors: Kenji Marshall &lt;kenji.marshall99@gmail.com&gt;</span>
<span class="c1">#          Charlotte Maschke &lt;charlotte.maschke@mail.mcgill.ca&gt;</span>
<span class="c1">#          Stefanie Blain-Moraes &lt;stefanie.blain-moraes@mcgill.ca&gt;</span>
<span class="c1">#</span>
<span class="c1"># License: BSD (3-clause)</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">mne</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mne.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">sample</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">mne_connectivity</span><span class="w"> </span><span class="kn">import</span> <a href="../generated/mne_connectivity.spectral_connectivity_epochs.html#mne_connectivity.spectral_connectivity_epochs" title="mne_connectivity.spectral_connectivity_epochs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-function"><span class="n">spectral_connectivity_epochs</span></a>
</pre></div>
</div>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading">#</a></h2>
<p>The formulae for PLI, wPLI, and dPLI are given below. In these equations,
<span class="math notranslate nohighlight">\(X_{ij}\)</span> is the cross-spectral density (CSD) between two signals
<span class="math notranslate nohighlight">\(i, j\)</span>. Importantly, the imaginary component of the CSD is maximal
when the signals have a phase difference given by <span class="math notranslate nohighlight">\(k\pi+\frac{\pi}{2}\)</span>,
and is <span class="math notranslate nohighlight">\(0\)</span> when the phase difference is given by <span class="math notranslate nohighlight">\(k\pi\)</span> (where
<span class="math notranslate nohighlight">\(k \in \mathbb{Z}\)</span>). This property provides protection against
recognizing volume conduction effects as connectivity, and is the backbone
for these methods <a class="footnote-reference brackets" href="#footcite-vincketal2011" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. In the equations below,
<span class="math notranslate nohighlight">\(\mathcal{I}\)</span> refers to the imaginary component,
<span class="math notranslate nohighlight">\(\mathcal{H}\)</span> refers to the Heaviside step function, and
<span class="math notranslate nohighlight">\(sgn\)</span> refers to the sign function.</p>
<p><span class="math notranslate nohighlight">\(PLI = |E[sgn(\mathcal{I}(X_{ij}))]|\)</span> <a class="footnote-reference brackets" href="#footcite-stametal2007" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a></p>
<p><span class="math notranslate nohighlight">\(wPLI = \frac{|E[\mathcal{I}(X_{ij})]|}{E[|\mathcal{I}(X_{ij})|]}\)</span>
<a class="footnote-reference brackets" href="#footcite-vincketal2011" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a></p>
<p><span class="math notranslate nohighlight">\(dPLI = E[\mathcal{H}(\mathcal{I}(X_{ij}))]\)</span> <a class="footnote-reference brackets" href="#footcite-stametal2012" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a></p>
<p>All three of these metrics are bounded in the range <span class="math notranslate nohighlight">\([0, 1]\)</span>.</p>
<ul class="simple">
<li><p>For PLI, <span class="math notranslate nohighlight">\(0\)</span> means that signal <span class="math notranslate nohighlight">\(i\)</span> leads and lags signal
<span class="math notranslate nohighlight">\(j\)</span> equally often, while a value greater than <span class="math notranslate nohighlight">\(0\)</span> means that
there is an imbalance in the likelihood for signal <span class="math notranslate nohighlight">\(i\)</span> to be leading
or lagging. A value of <span class="math notranslate nohighlight">\(1\)</span> means that signal <span class="math notranslate nohighlight">\(i\)</span> only leads or
only lags signal <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
<li><p>For wPLI, <span class="math notranslate nohighlight">\(0\)</span> means that the total weight (not the quantity) of all
leading relationships equals the total weight of lagging relationships,
while a value greater than <span class="math notranslate nohighlight">\(0\)</span> means that there is an imbalance
between these weights. A value of <span class="math notranslate nohighlight">\(1\)</span>, just as in PLI, means that
signal <span class="math notranslate nohighlight">\(i\)</span> only leads or only lags signal <span class="math notranslate nohighlight">\(j\)</span>.</p></li>
<li><p>With dPLI, we gain the ability to distinguish whether signal <span class="math notranslate nohighlight">\(i\)</span> is
leading or lagging signal <span class="math notranslate nohighlight">\(j\)</span>, complementing the information provided
by PLI or wPLI. A value of <span class="math notranslate nohighlight">\(0.5\)</span> means that signal <span class="math notranslate nohighlight">\(i\)</span> leads
and lags signal <span class="math notranslate nohighlight">\(j\)</span> equally often. A value in the range
<span class="math notranslate nohighlight">\((0.5, 1.0]\)</span> means that signal <span class="math notranslate nohighlight">\(i\)</span> leads signal <span class="math notranslate nohighlight">\(j\)</span> more
often than it lags, with a value of <span class="math notranslate nohighlight">\(1\)</span> meaning that signal <span class="math notranslate nohighlight">\(i\)</span>
always leads signal <span class="math notranslate nohighlight">\(j\)</span>. A value in the range <span class="math notranslate nohighlight">\([0.0, 0.5)\)</span>
means that signal <span class="math notranslate nohighlight">\(i\)</span> lags signal <span class="math notranslate nohighlight">\(j\)</span> more often than it leads,
with a value of <span class="math notranslate nohighlight">\(0\)</span> meaning that signal <span class="math notranslate nohighlight">\(i\)</span> always lags signal
<span class="math notranslate nohighlight">\(j\)</span>. The PLI can actually be extracted from the dPLI by the
relationship <span class="math notranslate nohighlight">\(PLI = 2|dPLI - 0.5|\)</span>, but this relationship is not
invertible (dPLI can not be estimated from the PLI).</p></li>
</ul>
<p>Overall, these different approaches are closely related but have subtle
differences, as will be demonstrated throughout the rest of this example.</p>
</section>
<section id="capturing-leading-lagging-phase-relationships-with-dpli">
<h2>Capturing Leading/Lagging Phase Relationships with dPLI<a class="headerlink" href="#capturing-leading-lagging-phase-relationships-with-dpli" title="Link to this heading">#</a></h2>
<p>The main advantage of dPLI is that it’s <em>directed</em>, meaning it can
differentiate between phase relationships which are leading or lagging.
To illustrate this, we generate sinusoids with Gaussian noise. In particular,
we generate signals with phase differences of
<span class="math notranslate nohighlight">\([-\pi, -\frac{\pi}{2}, 0, \frac{\pi}{2}, \pi]\)</span> relative to a reference
signal. A negative difference means that the reference signal is lagging the
other signal.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a> <span class="o">=</span> <span class="mi">250</span>  <span class="c1"># sampling rate (Hz)</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_e</span></a> <span class="o">=</span> <span class="mi">300</span>  <span class="c1"># number of epochs</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">T</span></a> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># length of epochs (s)</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># frequency of sinusoids (Hz)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">T</span></a><span class="p">,</span> <span class="mi">1</span> <span class="o">/</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">A</span></a> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># noise amplitude</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sigma</span></a> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Gaussian noise variance</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a> <span class="o">=</span> <span class="p">[]</span>

<a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phase_differences</span></a> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a><span class="p">,</span> <span class="o">-</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a><span class="p">]</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ps</span></a> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">phase_differences</span></a><span class="p">):</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sig</span></a> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">_</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_e</span></a><span class="p">):</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sig</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <a href="https://numpy.org/devdocs/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a> <span class="o">-</span> <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ps</span></a><span class="p">)</span>
            <span class="o">+</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">A</span></a> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/random/generated/numpy.random.normal.html#numpy.random.normal" title="numpy.random.normal" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sigma</span></a><span class="p">,</span> <span class="n">size</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span><span class="o">.</span><span class="n">shape</span></a><span class="p">)</span>
        <span class="p">)</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sig</span></a><span class="p">)</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.swapaxes.html#numpy.swapaxes" title="numpy.swapaxes" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># make epochs the first dimension</span>
</pre></div>
</div>
<p>A snippet of this simulated data is shown below. The blue signal is the
reference signal.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">[:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">],</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Reference&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">[:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">],</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">])</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Phase Lagging ($-\pi/2$ Phase Difference)&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Signal&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">[:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">],</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Reference&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">[:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">],</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">])</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Phase Leading ($\pi/2$ Phase Difference)&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_dpli_wpli_pli_001.png" srcset="../_images/sphx_glr_dpli_wpli_pli_001.png" alt="Phase Lagging ($-\pi/2$ Phase Difference), Phase Leading ($\pi/2$ Phase Difference)" class = "sphx-glr-single-img"/><p>We will now compute PLI, wPLI, and dPLI for each phase relationship.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a> <span class="o">=</span> <span class="p">[]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">indices</span></a> <span class="o">=</span> <span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pli&quot;</span><span class="p">,</span> <span class="s2">&quot;wpli&quot;</span><span class="p">,</span> <span class="s2">&quot;dpli&quot;</span><span class="p">]:</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span>
        <a href="../generated/mne_connectivity.spectral_connectivity_epochs.html#mne_connectivity.spectral_connectivity_epochs" title="mne_connectivity.spectral_connectivity_epochs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-function"><span class="n">spectral_connectivity_epochs</span></a><span class="p">(</span>
            <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">indices</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">indices</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">faverage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Connectivity computation...
    using t=0.000s..9.996s for estimation (2500 points)
    frequencies: 9.0Hz..11.0Hz (21 points)
    connectivity scores will be averaged for each band
    computing connectivity for 5 connections
    Using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: PLI
    computing cross-spectral density for epoch 1
    computing cross-spectral density for epoch 2
    computing cross-spectral density for epoch 3
    computing cross-spectral density for epoch 4
    computing cross-spectral density for epoch 5
    computing cross-spectral density for epoch 6
    computing cross-spectral density for epoch 7
    computing cross-spectral density for epoch 8
    computing cross-spectral density for epoch 9
    computing cross-spectral density for epoch 10
    computing cross-spectral density for epoch 11
    computing cross-spectral density for epoch 12
    computing cross-spectral density for epoch 13
    computing cross-spectral density for epoch 14
    computing cross-spectral density for epoch 15
    computing cross-spectral density for epoch 16
    computing cross-spectral density for epoch 17
    computing cross-spectral density for epoch 18
    computing cross-spectral density for epoch 19
    computing cross-spectral density for epoch 20
    computing cross-spectral density for epoch 21
    computing cross-spectral density for epoch 22
    computing cross-spectral density for epoch 23
    computing cross-spectral density for epoch 24
    computing cross-spectral density for epoch 25
    computing cross-spectral density for epoch 26
    computing cross-spectral density for epoch 27
    computing cross-spectral density for epoch 28
    computing cross-spectral density for epoch 29
    computing cross-spectral density for epoch 30
    computing cross-spectral density for epoch 31
    computing cross-spectral density for epoch 32
    computing cross-spectral density for epoch 33
    computing cross-spectral density for epoch 34
    computing cross-spectral density for epoch 35
    computing cross-spectral density for epoch 36
    computing cross-spectral density for epoch 37
    computing cross-spectral density for epoch 38
    computing cross-spectral density for epoch 39
    computing cross-spectral density for epoch 40
    computing cross-spectral density for epoch 41
    computing cross-spectral density for epoch 42
    computing cross-spectral density for epoch 43
    computing cross-spectral density for epoch 44
    computing cross-spectral density for epoch 45
    computing cross-spectral density for epoch 46
    computing cross-spectral density for epoch 47
    computing cross-spectral density for epoch 48
    computing cross-spectral density for epoch 49
    computing cross-spectral density for epoch 50
    computing cross-spectral density for epoch 51
    computing cross-spectral density for epoch 52
    computing cross-spectral density for epoch 53
    computing cross-spectral density for epoch 54
    computing cross-spectral density for epoch 55
    computing cross-spectral density for epoch 56
    computing cross-spectral density for epoch 57
    computing cross-spectral density for epoch 58
    computing cross-spectral density for epoch 59
    computing cross-spectral density for epoch 60
    computing cross-spectral density for epoch 61
    computing cross-spectral density for epoch 62
    computing cross-spectral density for epoch 63
    computing cross-spectral density for epoch 64
    computing cross-spectral density for epoch 65
    computing cross-spectral density for epoch 66
    computing cross-spectral density for epoch 67
    computing cross-spectral density for epoch 68
    computing cross-spectral density for epoch 69
    computing cross-spectral density for epoch 70
    computing cross-spectral density for epoch 71
    computing cross-spectral density for epoch 72
    computing cross-spectral density for epoch 73
    computing cross-spectral density for epoch 74
    computing cross-spectral density for epoch 75
    computing cross-spectral density for epoch 76
    computing cross-spectral density for epoch 77
    computing cross-spectral density for epoch 78
    computing cross-spectral density for epoch 79
    computing cross-spectral density for epoch 80
    computing cross-spectral density for epoch 81
    computing cross-spectral density for epoch 82
    computing cross-spectral density for epoch 83
    computing cross-spectral density for epoch 84
    computing cross-spectral density for epoch 85
    computing cross-spectral density for epoch 86
    computing cross-spectral density for epoch 87
    computing cross-spectral density for epoch 88
    computing cross-spectral density for epoch 89
    computing cross-spectral density for epoch 90
    computing cross-spectral density for epoch 91
    computing cross-spectral density for epoch 92
    computing cross-spectral density for epoch 93
    computing cross-spectral density for epoch 94
    computing cross-spectral density for epoch 95
    computing cross-spectral density for epoch 96
    computing cross-spectral density for epoch 97
    computing cross-spectral density for epoch 98
    computing cross-spectral density for epoch 99
    computing cross-spectral density for epoch 100
    computing cross-spectral density for epoch 101
    computing cross-spectral density for epoch 102
    computing cross-spectral density for epoch 103
    computing cross-spectral density for epoch 104
    computing cross-spectral density for epoch 105
    computing cross-spectral density for epoch 106
    computing cross-spectral density for epoch 107
    computing cross-spectral density for epoch 108
    computing cross-spectral density for epoch 109
    computing cross-spectral density for epoch 110
    computing cross-spectral density for epoch 111
    computing cross-spectral density for epoch 112
    computing cross-spectral density for epoch 113
    computing cross-spectral density for epoch 114
    computing cross-spectral density for epoch 115
    computing cross-spectral density for epoch 116
    computing cross-spectral density for epoch 117
    computing cross-spectral density for epoch 118
    computing cross-spectral density for epoch 119
    computing cross-spectral density for epoch 120
    computing cross-spectral density for epoch 121
    computing cross-spectral density for epoch 122
    computing cross-spectral density for epoch 123
    computing cross-spectral density for epoch 124
    computing cross-spectral density for epoch 125
    computing cross-spectral density for epoch 126
    computing cross-spectral density for epoch 127
    computing cross-spectral density for epoch 128
    computing cross-spectral density for epoch 129
    computing cross-spectral density for epoch 130
    computing cross-spectral density for epoch 131
    computing cross-spectral density for epoch 132
    computing cross-spectral density for epoch 133
    computing cross-spectral density for epoch 134
    computing cross-spectral density for epoch 135
    computing cross-spectral density for epoch 136
    computing cross-spectral density for epoch 137
    computing cross-spectral density for epoch 138
    computing cross-spectral density for epoch 139
    computing cross-spectral density for epoch 140
    computing cross-spectral density for epoch 141
    computing cross-spectral density for epoch 142
    computing cross-spectral density for epoch 143
    computing cross-spectral density for epoch 144
    computing cross-spectral density for epoch 145
    computing cross-spectral density for epoch 146
    computing cross-spectral density for epoch 147
    computing cross-spectral density for epoch 148
    computing cross-spectral density for epoch 149
    computing cross-spectral density for epoch 150
    computing cross-spectral density for epoch 151
    computing cross-spectral density for epoch 152
    computing cross-spectral density for epoch 153
    computing cross-spectral density for epoch 154
    computing cross-spectral density for epoch 155
    computing cross-spectral density for epoch 156
    computing cross-spectral density for epoch 157
    computing cross-spectral density for epoch 158
    computing cross-spectral density for epoch 159
    computing cross-spectral density for epoch 160
    computing cross-spectral density for epoch 161
    computing cross-spectral density for epoch 162
    computing cross-spectral density for epoch 163
    computing cross-spectral density for epoch 164
    computing cross-spectral density for epoch 165
    computing cross-spectral density for epoch 166
    computing cross-spectral density for epoch 167
    computing cross-spectral density for epoch 168
    computing cross-spectral density for epoch 169
    computing cross-spectral density for epoch 170
    computing cross-spectral density for epoch 171
    computing cross-spectral density for epoch 172
    computing cross-spectral density for epoch 173
    computing cross-spectral density for epoch 174
    computing cross-spectral density for epoch 175
    computing cross-spectral density for epoch 176
    computing cross-spectral density for epoch 177
    computing cross-spectral density for epoch 178
    computing cross-spectral density for epoch 179
    computing cross-spectral density for epoch 180
    computing cross-spectral density for epoch 181
    computing cross-spectral density for epoch 182
    computing cross-spectral density for epoch 183
    computing cross-spectral density for epoch 184
    computing cross-spectral density for epoch 185
    computing cross-spectral density for epoch 186
    computing cross-spectral density for epoch 187
    computing cross-spectral density for epoch 188
    computing cross-spectral density for epoch 189
    computing cross-spectral density for epoch 190
    computing cross-spectral density for epoch 191
    computing cross-spectral density for epoch 192
    computing cross-spectral density for epoch 193
    computing cross-spectral density for epoch 194
    computing cross-spectral density for epoch 195
    computing cross-spectral density for epoch 196
    computing cross-spectral density for epoch 197
    computing cross-spectral density for epoch 198
    computing cross-spectral density for epoch 199
    computing cross-spectral density for epoch 200
    computing cross-spectral density for epoch 201
    computing cross-spectral density for epoch 202
    computing cross-spectral density for epoch 203
    computing cross-spectral density for epoch 204
    computing cross-spectral density for epoch 205
    computing cross-spectral density for epoch 206
    computing cross-spectral density for epoch 207
    computing cross-spectral density for epoch 208
    computing cross-spectral density for epoch 209
    computing cross-spectral density for epoch 210
    computing cross-spectral density for epoch 211
    computing cross-spectral density for epoch 212
    computing cross-spectral density for epoch 213
    computing cross-spectral density for epoch 214
    computing cross-spectral density for epoch 215
    computing cross-spectral density for epoch 216
    computing cross-spectral density for epoch 217
    computing cross-spectral density for epoch 218
    computing cross-spectral density for epoch 219
    computing cross-spectral density for epoch 220
    computing cross-spectral density for epoch 221
    computing cross-spectral density for epoch 222
    computing cross-spectral density for epoch 223
    computing cross-spectral density for epoch 224
    computing cross-spectral density for epoch 225
    computing cross-spectral density for epoch 226
    computing cross-spectral density for epoch 227
    computing cross-spectral density for epoch 228
    computing cross-spectral density for epoch 229
    computing cross-spectral density for epoch 230
    computing cross-spectral density for epoch 231
    computing cross-spectral density for epoch 232
    computing cross-spectral density for epoch 233
    computing cross-spectral density for epoch 234
    computing cross-spectral density for epoch 235
    computing cross-spectral density for epoch 236
    computing cross-spectral density for epoch 237
    computing cross-spectral density for epoch 238
    computing cross-spectral density for epoch 239
    computing cross-spectral density for epoch 240
    computing cross-spectral density for epoch 241
    computing cross-spectral density for epoch 242
    computing cross-spectral density for epoch 243
    computing cross-spectral density for epoch 244
    computing cross-spectral density for epoch 245
    computing cross-spectral density for epoch 246
    computing cross-spectral density for epoch 247
    computing cross-spectral density for epoch 248
    computing cross-spectral density for epoch 249
    computing cross-spectral density for epoch 250
    computing cross-spectral density for epoch 251
    computing cross-spectral density for epoch 252
    computing cross-spectral density for epoch 253
    computing cross-spectral density for epoch 254
    computing cross-spectral density for epoch 255
    computing cross-spectral density for epoch 256
    computing cross-spectral density for epoch 257
    computing cross-spectral density for epoch 258
    computing cross-spectral density for epoch 259
    computing cross-spectral density for epoch 260
    computing cross-spectral density for epoch 261
    computing cross-spectral density for epoch 262
    computing cross-spectral density for epoch 263
    computing cross-spectral density for epoch 264
    computing cross-spectral density for epoch 265
    computing cross-spectral density for epoch 266
    computing cross-spectral density for epoch 267
    computing cross-spectral density for epoch 268
    computing cross-spectral density for epoch 269
    computing cross-spectral density for epoch 270
    computing cross-spectral density for epoch 271
    computing cross-spectral density for epoch 272
    computing cross-spectral density for epoch 273
    computing cross-spectral density for epoch 274
    computing cross-spectral density for epoch 275
    computing cross-spectral density for epoch 276
    computing cross-spectral density for epoch 277
    computing cross-spectral density for epoch 278
    computing cross-spectral density for epoch 279
    computing cross-spectral density for epoch 280
    computing cross-spectral density for epoch 281
    computing cross-spectral density for epoch 282
    computing cross-spectral density for epoch 283
    computing cross-spectral density for epoch 284
    computing cross-spectral density for epoch 285
    computing cross-spectral density for epoch 286
    computing cross-spectral density for epoch 287
    computing cross-spectral density for epoch 288
    computing cross-spectral density for epoch 289
    computing cross-spectral density for epoch 290
    computing cross-spectral density for epoch 291
    computing cross-spectral density for epoch 292
    computing cross-spectral density for epoch 293
    computing cross-spectral density for epoch 294
    computing cross-spectral density for epoch 295
    computing cross-spectral density for epoch 296
    computing cross-spectral density for epoch 297
    computing cross-spectral density for epoch 298
    computing cross-spectral density for epoch 299
    computing cross-spectral density for epoch 300
[Connectivity computation done]
Connectivity computation...
    using t=0.000s..9.996s for estimation (2500 points)
    frequencies: 9.0Hz..11.0Hz (21 points)
    connectivity scores will be averaged for each band
    computing connectivity for 5 connections
    Using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: WPLI
    computing cross-spectral density for epoch 1
    computing cross-spectral density for epoch 2
    computing cross-spectral density for epoch 3
    computing cross-spectral density for epoch 4
    computing cross-spectral density for epoch 5
    computing cross-spectral density for epoch 6
    computing cross-spectral density for epoch 7
    computing cross-spectral density for epoch 8
    computing cross-spectral density for epoch 9
    computing cross-spectral density for epoch 10
    computing cross-spectral density for epoch 11
    computing cross-spectral density for epoch 12
    computing cross-spectral density for epoch 13
    computing cross-spectral density for epoch 14
    computing cross-spectral density for epoch 15
    computing cross-spectral density for epoch 16
    computing cross-spectral density for epoch 17
    computing cross-spectral density for epoch 18
    computing cross-spectral density for epoch 19
    computing cross-spectral density for epoch 20
    computing cross-spectral density for epoch 21
    computing cross-spectral density for epoch 22
    computing cross-spectral density for epoch 23
    computing cross-spectral density for epoch 24
    computing cross-spectral density for epoch 25
    computing cross-spectral density for epoch 26
    computing cross-spectral density for epoch 27
    computing cross-spectral density for epoch 28
    computing cross-spectral density for epoch 29
    computing cross-spectral density for epoch 30
    computing cross-spectral density for epoch 31
    computing cross-spectral density for epoch 32
    computing cross-spectral density for epoch 33
    computing cross-spectral density for epoch 34
    computing cross-spectral density for epoch 35
    computing cross-spectral density for epoch 36
    computing cross-spectral density for epoch 37
    computing cross-spectral density for epoch 38
    computing cross-spectral density for epoch 39
    computing cross-spectral density for epoch 40
    computing cross-spectral density for epoch 41
    computing cross-spectral density for epoch 42
    computing cross-spectral density for epoch 43
    computing cross-spectral density for epoch 44
    computing cross-spectral density for epoch 45
    computing cross-spectral density for epoch 46
    computing cross-spectral density for epoch 47
    computing cross-spectral density for epoch 48
    computing cross-spectral density for epoch 49
    computing cross-spectral density for epoch 50
    computing cross-spectral density for epoch 51
    computing cross-spectral density for epoch 52
    computing cross-spectral density for epoch 53
    computing cross-spectral density for epoch 54
    computing cross-spectral density for epoch 55
    computing cross-spectral density for epoch 56
    computing cross-spectral density for epoch 57
    computing cross-spectral density for epoch 58
    computing cross-spectral density for epoch 59
    computing cross-spectral density for epoch 60
    computing cross-spectral density for epoch 61
    computing cross-spectral density for epoch 62
    computing cross-spectral density for epoch 63
    computing cross-spectral density for epoch 64
    computing cross-spectral density for epoch 65
    computing cross-spectral density for epoch 66
    computing cross-spectral density for epoch 67
    computing cross-spectral density for epoch 68
    computing cross-spectral density for epoch 69
    computing cross-spectral density for epoch 70
    computing cross-spectral density for epoch 71
    computing cross-spectral density for epoch 72
    computing cross-spectral density for epoch 73
    computing cross-spectral density for epoch 74
    computing cross-spectral density for epoch 75
    computing cross-spectral density for epoch 76
    computing cross-spectral density for epoch 77
    computing cross-spectral density for epoch 78
    computing cross-spectral density for epoch 79
    computing cross-spectral density for epoch 80
    computing cross-spectral density for epoch 81
    computing cross-spectral density for epoch 82
    computing cross-spectral density for epoch 83
    computing cross-spectral density for epoch 84
    computing cross-spectral density for epoch 85
    computing cross-spectral density for epoch 86
    computing cross-spectral density for epoch 87
    computing cross-spectral density for epoch 88
    computing cross-spectral density for epoch 89
    computing cross-spectral density for epoch 90
    computing cross-spectral density for epoch 91
    computing cross-spectral density for epoch 92
    computing cross-spectral density for epoch 93
    computing cross-spectral density for epoch 94
    computing cross-spectral density for epoch 95
    computing cross-spectral density for epoch 96
    computing cross-spectral density for epoch 97
    computing cross-spectral density for epoch 98
    computing cross-spectral density for epoch 99
    computing cross-spectral density for epoch 100
    computing cross-spectral density for epoch 101
    computing cross-spectral density for epoch 102
    computing cross-spectral density for epoch 103
    computing cross-spectral density for epoch 104
    computing cross-spectral density for epoch 105
    computing cross-spectral density for epoch 106
    computing cross-spectral density for epoch 107
    computing cross-spectral density for epoch 108
    computing cross-spectral density for epoch 109
    computing cross-spectral density for epoch 110
    computing cross-spectral density for epoch 111
    computing cross-spectral density for epoch 112
    computing cross-spectral density for epoch 113
    computing cross-spectral density for epoch 114
    computing cross-spectral density for epoch 115
    computing cross-spectral density for epoch 116
    computing cross-spectral density for epoch 117
    computing cross-spectral density for epoch 118
    computing cross-spectral density for epoch 119
    computing cross-spectral density for epoch 120
    computing cross-spectral density for epoch 121
    computing cross-spectral density for epoch 122
    computing cross-spectral density for epoch 123
    computing cross-spectral density for epoch 124
    computing cross-spectral density for epoch 125
    computing cross-spectral density for epoch 126
    computing cross-spectral density for epoch 127
    computing cross-spectral density for epoch 128
    computing cross-spectral density for epoch 129
    computing cross-spectral density for epoch 130
    computing cross-spectral density for epoch 131
    computing cross-spectral density for epoch 132
    computing cross-spectral density for epoch 133
    computing cross-spectral density for epoch 134
    computing cross-spectral density for epoch 135
    computing cross-spectral density for epoch 136
    computing cross-spectral density for epoch 137
    computing cross-spectral density for epoch 138
    computing cross-spectral density for epoch 139
    computing cross-spectral density for epoch 140
    computing cross-spectral density for epoch 141
    computing cross-spectral density for epoch 142
    computing cross-spectral density for epoch 143
    computing cross-spectral density for epoch 144
    computing cross-spectral density for epoch 145
    computing cross-spectral density for epoch 146
    computing cross-spectral density for epoch 147
    computing cross-spectral density for epoch 148
    computing cross-spectral density for epoch 149
    computing cross-spectral density for epoch 150
    computing cross-spectral density for epoch 151
    computing cross-spectral density for epoch 152
    computing cross-spectral density for epoch 153
    computing cross-spectral density for epoch 154
    computing cross-spectral density for epoch 155
    computing cross-spectral density for epoch 156
    computing cross-spectral density for epoch 157
    computing cross-spectral density for epoch 158
    computing cross-spectral density for epoch 159
    computing cross-spectral density for epoch 160
    computing cross-spectral density for epoch 161
    computing cross-spectral density for epoch 162
    computing cross-spectral density for epoch 163
    computing cross-spectral density for epoch 164
    computing cross-spectral density for epoch 165
    computing cross-spectral density for epoch 166
    computing cross-spectral density for epoch 167
    computing cross-spectral density for epoch 168
    computing cross-spectral density for epoch 169
    computing cross-spectral density for epoch 170
    computing cross-spectral density for epoch 171
    computing cross-spectral density for epoch 172
    computing cross-spectral density for epoch 173
    computing cross-spectral density for epoch 174
    computing cross-spectral density for epoch 175
    computing cross-spectral density for epoch 176
    computing cross-spectral density for epoch 177
    computing cross-spectral density for epoch 178
    computing cross-spectral density for epoch 179
    computing cross-spectral density for epoch 180
    computing cross-spectral density for epoch 181
    computing cross-spectral density for epoch 182
    computing cross-spectral density for epoch 183
    computing cross-spectral density for epoch 184
    computing cross-spectral density for epoch 185
    computing cross-spectral density for epoch 186
    computing cross-spectral density for epoch 187
    computing cross-spectral density for epoch 188
    computing cross-spectral density for epoch 189
    computing cross-spectral density for epoch 190
    computing cross-spectral density for epoch 191
    computing cross-spectral density for epoch 192
    computing cross-spectral density for epoch 193
    computing cross-spectral density for epoch 194
    computing cross-spectral density for epoch 195
    computing cross-spectral density for epoch 196
    computing cross-spectral density for epoch 197
    computing cross-spectral density for epoch 198
    computing cross-spectral density for epoch 199
    computing cross-spectral density for epoch 200
    computing cross-spectral density for epoch 201
    computing cross-spectral density for epoch 202
    computing cross-spectral density for epoch 203
    computing cross-spectral density for epoch 204
    computing cross-spectral density for epoch 205
    computing cross-spectral density for epoch 206
    computing cross-spectral density for epoch 207
    computing cross-spectral density for epoch 208
    computing cross-spectral density for epoch 209
    computing cross-spectral density for epoch 210
    computing cross-spectral density for epoch 211
    computing cross-spectral density for epoch 212
    computing cross-spectral density for epoch 213
    computing cross-spectral density for epoch 214
    computing cross-spectral density for epoch 215
    computing cross-spectral density for epoch 216
    computing cross-spectral density for epoch 217
    computing cross-spectral density for epoch 218
    computing cross-spectral density for epoch 219
    computing cross-spectral density for epoch 220
    computing cross-spectral density for epoch 221
    computing cross-spectral density for epoch 222
    computing cross-spectral density for epoch 223
    computing cross-spectral density for epoch 224
    computing cross-spectral density for epoch 225
    computing cross-spectral density for epoch 226
    computing cross-spectral density for epoch 227
    computing cross-spectral density for epoch 228
    computing cross-spectral density for epoch 229
    computing cross-spectral density for epoch 230
    computing cross-spectral density for epoch 231
    computing cross-spectral density for epoch 232
    computing cross-spectral density for epoch 233
    computing cross-spectral density for epoch 234
    computing cross-spectral density for epoch 235
    computing cross-spectral density for epoch 236
    computing cross-spectral density for epoch 237
    computing cross-spectral density for epoch 238
    computing cross-spectral density for epoch 239
    computing cross-spectral density for epoch 240
    computing cross-spectral density for epoch 241
    computing cross-spectral density for epoch 242
    computing cross-spectral density for epoch 243
    computing cross-spectral density for epoch 244
    computing cross-spectral density for epoch 245
    computing cross-spectral density for epoch 246
    computing cross-spectral density for epoch 247
    computing cross-spectral density for epoch 248
    computing cross-spectral density for epoch 249
    computing cross-spectral density for epoch 250
    computing cross-spectral density for epoch 251
    computing cross-spectral density for epoch 252
    computing cross-spectral density for epoch 253
    computing cross-spectral density for epoch 254
    computing cross-spectral density for epoch 255
    computing cross-spectral density for epoch 256
    computing cross-spectral density for epoch 257
    computing cross-spectral density for epoch 258
    computing cross-spectral density for epoch 259
    computing cross-spectral density for epoch 260
    computing cross-spectral density for epoch 261
    computing cross-spectral density for epoch 262
    computing cross-spectral density for epoch 263
    computing cross-spectral density for epoch 264
    computing cross-spectral density for epoch 265
    computing cross-spectral density for epoch 266
    computing cross-spectral density for epoch 267
    computing cross-spectral density for epoch 268
    computing cross-spectral density for epoch 269
    computing cross-spectral density for epoch 270
    computing cross-spectral density for epoch 271
    computing cross-spectral density for epoch 272
    computing cross-spectral density for epoch 273
    computing cross-spectral density for epoch 274
    computing cross-spectral density for epoch 275
    computing cross-spectral density for epoch 276
    computing cross-spectral density for epoch 277
    computing cross-spectral density for epoch 278
    computing cross-spectral density for epoch 279
    computing cross-spectral density for epoch 280
    computing cross-spectral density for epoch 281
    computing cross-spectral density for epoch 282
    computing cross-spectral density for epoch 283
    computing cross-spectral density for epoch 284
    computing cross-spectral density for epoch 285
    computing cross-spectral density for epoch 286
    computing cross-spectral density for epoch 287
    computing cross-spectral density for epoch 288
    computing cross-spectral density for epoch 289
    computing cross-spectral density for epoch 290
    computing cross-spectral density for epoch 291
    computing cross-spectral density for epoch 292
    computing cross-spectral density for epoch 293
    computing cross-spectral density for epoch 294
    computing cross-spectral density for epoch 295
    computing cross-spectral density for epoch 296
    computing cross-spectral density for epoch 297
    computing cross-spectral density for epoch 298
    computing cross-spectral density for epoch 299
    computing cross-spectral density for epoch 300
[Connectivity computation done]
Connectivity computation...
    using t=0.000s..9.996s for estimation (2500 points)
    frequencies: 9.0Hz..11.0Hz (21 points)
    connectivity scores will be averaged for each band
    computing connectivity for 5 connections
    Using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: DPLI
    computing cross-spectral density for epoch 1
    computing cross-spectral density for epoch 2
    computing cross-spectral density for epoch 3
    computing cross-spectral density for epoch 4
    computing cross-spectral density for epoch 5
    computing cross-spectral density for epoch 6
    computing cross-spectral density for epoch 7
    computing cross-spectral density for epoch 8
    computing cross-spectral density for epoch 9
    computing cross-spectral density for epoch 10
    computing cross-spectral density for epoch 11
    computing cross-spectral density for epoch 12
    computing cross-spectral density for epoch 13
    computing cross-spectral density for epoch 14
    computing cross-spectral density for epoch 15
    computing cross-spectral density for epoch 16
    computing cross-spectral density for epoch 17
    computing cross-spectral density for epoch 18
    computing cross-spectral density for epoch 19
    computing cross-spectral density for epoch 20
    computing cross-spectral density for epoch 21
    computing cross-spectral density for epoch 22
    computing cross-spectral density for epoch 23
    computing cross-spectral density for epoch 24
    computing cross-spectral density for epoch 25
    computing cross-spectral density for epoch 26
    computing cross-spectral density for epoch 27
    computing cross-spectral density for epoch 28
    computing cross-spectral density for epoch 29
    computing cross-spectral density for epoch 30
    computing cross-spectral density for epoch 31
    computing cross-spectral density for epoch 32
    computing cross-spectral density for epoch 33
    computing cross-spectral density for epoch 34
    computing cross-spectral density for epoch 35
    computing cross-spectral density for epoch 36
    computing cross-spectral density for epoch 37
    computing cross-spectral density for epoch 38
    computing cross-spectral density for epoch 39
    computing cross-spectral density for epoch 40
    computing cross-spectral density for epoch 41
    computing cross-spectral density for epoch 42
    computing cross-spectral density for epoch 43
    computing cross-spectral density for epoch 44
    computing cross-spectral density for epoch 45
    computing cross-spectral density for epoch 46
    computing cross-spectral density for epoch 47
    computing cross-spectral density for epoch 48
    computing cross-spectral density for epoch 49
    computing cross-spectral density for epoch 50
    computing cross-spectral density for epoch 51
    computing cross-spectral density for epoch 52
    computing cross-spectral density for epoch 53
    computing cross-spectral density for epoch 54
    computing cross-spectral density for epoch 55
    computing cross-spectral density for epoch 56
    computing cross-spectral density for epoch 57
    computing cross-spectral density for epoch 58
    computing cross-spectral density for epoch 59
    computing cross-spectral density for epoch 60
    computing cross-spectral density for epoch 61
    computing cross-spectral density for epoch 62
    computing cross-spectral density for epoch 63
    computing cross-spectral density for epoch 64
    computing cross-spectral density for epoch 65
    computing cross-spectral density for epoch 66
    computing cross-spectral density for epoch 67
    computing cross-spectral density for epoch 68
    computing cross-spectral density for epoch 69
    computing cross-spectral density for epoch 70
    computing cross-spectral density for epoch 71
    computing cross-spectral density for epoch 72
    computing cross-spectral density for epoch 73
    computing cross-spectral density for epoch 74
    computing cross-spectral density for epoch 75
    computing cross-spectral density for epoch 76
    computing cross-spectral density for epoch 77
    computing cross-spectral density for epoch 78
    computing cross-spectral density for epoch 79
    computing cross-spectral density for epoch 80
    computing cross-spectral density for epoch 81
    computing cross-spectral density for epoch 82
    computing cross-spectral density for epoch 83
    computing cross-spectral density for epoch 84
    computing cross-spectral density for epoch 85
    computing cross-spectral density for epoch 86
    computing cross-spectral density for epoch 87
    computing cross-spectral density for epoch 88
    computing cross-spectral density for epoch 89
    computing cross-spectral density for epoch 90
    computing cross-spectral density for epoch 91
    computing cross-spectral density for epoch 92
    computing cross-spectral density for epoch 93
    computing cross-spectral density for epoch 94
    computing cross-spectral density for epoch 95
    computing cross-spectral density for epoch 96
    computing cross-spectral density for epoch 97
    computing cross-spectral density for epoch 98
    computing cross-spectral density for epoch 99
    computing cross-spectral density for epoch 100
    computing cross-spectral density for epoch 101
    computing cross-spectral density for epoch 102
    computing cross-spectral density for epoch 103
    computing cross-spectral density for epoch 104
    computing cross-spectral density for epoch 105
    computing cross-spectral density for epoch 106
    computing cross-spectral density for epoch 107
    computing cross-spectral density for epoch 108
    computing cross-spectral density for epoch 109
    computing cross-spectral density for epoch 110
    computing cross-spectral density for epoch 111
    computing cross-spectral density for epoch 112
    computing cross-spectral density for epoch 113
    computing cross-spectral density for epoch 114
    computing cross-spectral density for epoch 115
    computing cross-spectral density for epoch 116
    computing cross-spectral density for epoch 117
    computing cross-spectral density for epoch 118
    computing cross-spectral density for epoch 119
    computing cross-spectral density for epoch 120
    computing cross-spectral density for epoch 121
    computing cross-spectral density for epoch 122
    computing cross-spectral density for epoch 123
    computing cross-spectral density for epoch 124
    computing cross-spectral density for epoch 125
    computing cross-spectral density for epoch 126
    computing cross-spectral density for epoch 127
    computing cross-spectral density for epoch 128
    computing cross-spectral density for epoch 129
    computing cross-spectral density for epoch 130
    computing cross-spectral density for epoch 131
    computing cross-spectral density for epoch 132
    computing cross-spectral density for epoch 133
    computing cross-spectral density for epoch 134
    computing cross-spectral density for epoch 135
    computing cross-spectral density for epoch 136
    computing cross-spectral density for epoch 137
    computing cross-spectral density for epoch 138
    computing cross-spectral density for epoch 139
    computing cross-spectral density for epoch 140
    computing cross-spectral density for epoch 141
    computing cross-spectral density for epoch 142
    computing cross-spectral density for epoch 143
    computing cross-spectral density for epoch 144
    computing cross-spectral density for epoch 145
    computing cross-spectral density for epoch 146
    computing cross-spectral density for epoch 147
    computing cross-spectral density for epoch 148
    computing cross-spectral density for epoch 149
    computing cross-spectral density for epoch 150
    computing cross-spectral density for epoch 151
    computing cross-spectral density for epoch 152
    computing cross-spectral density for epoch 153
    computing cross-spectral density for epoch 154
    computing cross-spectral density for epoch 155
    computing cross-spectral density for epoch 156
    computing cross-spectral density for epoch 157
    computing cross-spectral density for epoch 158
    computing cross-spectral density for epoch 159
    computing cross-spectral density for epoch 160
    computing cross-spectral density for epoch 161
    computing cross-spectral density for epoch 162
    computing cross-spectral density for epoch 163
    computing cross-spectral density for epoch 164
    computing cross-spectral density for epoch 165
    computing cross-spectral density for epoch 166
    computing cross-spectral density for epoch 167
    computing cross-spectral density for epoch 168
    computing cross-spectral density for epoch 169
    computing cross-spectral density for epoch 170
    computing cross-spectral density for epoch 171
    computing cross-spectral density for epoch 172
    computing cross-spectral density for epoch 173
    computing cross-spectral density for epoch 174
    computing cross-spectral density for epoch 175
    computing cross-spectral density for epoch 176
    computing cross-spectral density for epoch 177
    computing cross-spectral density for epoch 178
    computing cross-spectral density for epoch 179
    computing cross-spectral density for epoch 180
    computing cross-spectral density for epoch 181
    computing cross-spectral density for epoch 182
    computing cross-spectral density for epoch 183
    computing cross-spectral density for epoch 184
    computing cross-spectral density for epoch 185
    computing cross-spectral density for epoch 186
    computing cross-spectral density for epoch 187
    computing cross-spectral density for epoch 188
    computing cross-spectral density for epoch 189
    computing cross-spectral density for epoch 190
    computing cross-spectral density for epoch 191
    computing cross-spectral density for epoch 192
    computing cross-spectral density for epoch 193
    computing cross-spectral density for epoch 194
    computing cross-spectral density for epoch 195
    computing cross-spectral density for epoch 196
    computing cross-spectral density for epoch 197
    computing cross-spectral density for epoch 198
    computing cross-spectral density for epoch 199
    computing cross-spectral density for epoch 200
    computing cross-spectral density for epoch 201
    computing cross-spectral density for epoch 202
    computing cross-spectral density for epoch 203
    computing cross-spectral density for epoch 204
    computing cross-spectral density for epoch 205
    computing cross-spectral density for epoch 206
    computing cross-spectral density for epoch 207
    computing cross-spectral density for epoch 208
    computing cross-spectral density for epoch 209
    computing cross-spectral density for epoch 210
    computing cross-spectral density for epoch 211
    computing cross-spectral density for epoch 212
    computing cross-spectral density for epoch 213
    computing cross-spectral density for epoch 214
    computing cross-spectral density for epoch 215
    computing cross-spectral density for epoch 216
    computing cross-spectral density for epoch 217
    computing cross-spectral density for epoch 218
    computing cross-spectral density for epoch 219
    computing cross-spectral density for epoch 220
    computing cross-spectral density for epoch 221
    computing cross-spectral density for epoch 222
    computing cross-spectral density for epoch 223
    computing cross-spectral density for epoch 224
    computing cross-spectral density for epoch 225
    computing cross-spectral density for epoch 226
    computing cross-spectral density for epoch 227
    computing cross-spectral density for epoch 228
    computing cross-spectral density for epoch 229
    computing cross-spectral density for epoch 230
    computing cross-spectral density for epoch 231
    computing cross-spectral density for epoch 232
    computing cross-spectral density for epoch 233
    computing cross-spectral density for epoch 234
    computing cross-spectral density for epoch 235
    computing cross-spectral density for epoch 236
    computing cross-spectral density for epoch 237
    computing cross-spectral density for epoch 238
    computing cross-spectral density for epoch 239
    computing cross-spectral density for epoch 240
    computing cross-spectral density for epoch 241
    computing cross-spectral density for epoch 242
    computing cross-spectral density for epoch 243
    computing cross-spectral density for epoch 244
    computing cross-spectral density for epoch 245
    computing cross-spectral density for epoch 246
    computing cross-spectral density for epoch 247
    computing cross-spectral density for epoch 248
    computing cross-spectral density for epoch 249
    computing cross-spectral density for epoch 250
    computing cross-spectral density for epoch 251
    computing cross-spectral density for epoch 252
    computing cross-spectral density for epoch 253
    computing cross-spectral density for epoch 254
    computing cross-spectral density for epoch 255
    computing cross-spectral density for epoch 256
    computing cross-spectral density for epoch 257
    computing cross-spectral density for epoch 258
    computing cross-spectral density for epoch 259
    computing cross-spectral density for epoch 260
    computing cross-spectral density for epoch 261
    computing cross-spectral density for epoch 262
    computing cross-spectral density for epoch 263
    computing cross-spectral density for epoch 264
    computing cross-spectral density for epoch 265
    computing cross-spectral density for epoch 266
    computing cross-spectral density for epoch 267
    computing cross-spectral density for epoch 268
    computing cross-spectral density for epoch 269
    computing cross-spectral density for epoch 270
    computing cross-spectral density for epoch 271
    computing cross-spectral density for epoch 272
    computing cross-spectral density for epoch 273
    computing cross-spectral density for epoch 274
    computing cross-spectral density for epoch 275
    computing cross-spectral density for epoch 276
    computing cross-spectral density for epoch 277
    computing cross-spectral density for epoch 278
    computing cross-spectral density for epoch 279
    computing cross-spectral density for epoch 280
    computing cross-spectral density for epoch 281
    computing cross-spectral density for epoch 282
    computing cross-spectral density for epoch 283
    computing cross-spectral density for epoch 284
    computing cross-spectral density for epoch 285
    computing cross-spectral density for epoch 286
    computing cross-spectral density for epoch 287
    computing cross-spectral density for epoch 288
    computing cross-spectral density for epoch 289
    computing cross-spectral density for epoch 290
    computing cross-spectral density for epoch 291
    computing cross-spectral density for epoch 292
    computing cross-spectral density for epoch 293
    computing cross-spectral density for epoch 294
    computing cross-spectral density for epoch 295
    computing cross-spectral density for epoch 296
    computing cross-spectral density for epoch 297
    computing cross-spectral density for epoch 298
    computing cross-spectral density for epoch 299
    computing cross-spectral density for epoch 300
[Connectivity computation done]
</pre></div>
</div>
<p>The estimated connectivites are shown in the figure below, which provides
insight into the differences between PLI/wPLI, and dPLI.</p>
<p><strong>Similarities Of All Measures</strong></p>
<ul class="simple">
<li><p>Capture presence of connectivity in same situations (phase difference of
<span class="math notranslate nohighlight">\(\pm\frac{\pi}{2}\)</span>)</p></li>
<li><p>Do not predict connectivity when phase difference is a multiple of
<span class="math notranslate nohighlight">\(\pi\)</span></p></li>
<li><p>Bounded between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span></p></li>
</ul>
<p><strong>How dPLI is Different Than PLI/wPLI</strong></p>
<ul class="simple">
<li><p>Null connectivity is <span class="math notranslate nohighlight">\(0\)</span> for PLI and wPLI, but <span class="math notranslate nohighlight">\(0.5\)</span> for dPLI</p></li>
<li><p>dPLI differentiates whether the reference signal is leading or lagging the
other signal (lagging if <span class="math notranslate nohighlight">\(0 &lt;= dPlI &lt; 0.5\)</span>, leading if
<span class="math notranslate nohighlight">\(0.5 &lt; dPLI &lt;= 1.0\)</span>)</p></li>
</ul>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">5</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.bar.html#matplotlib.pyplot.bar" title="matplotlib.pyplot.bar" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">bar</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a> <span class="o">-</span> <span class="mf">0.2</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;PLI&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.bar.html#matplotlib.pyplot.bar" title="matplotlib.pyplot.bar" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">bar</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;wPLI&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.bar.html#matplotlib.pyplot.bar" title="matplotlib.pyplot.bar" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">bar</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a> <span class="o">+</span> <span class="mf">0.2</span><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;dPLI&quot;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s2">&quot;Connectivity Estimation Comparison&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xticks.html#matplotlib.pyplot.xticks" title="matplotlib.pyplot.xticks" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xticks</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">x</span></a><span class="p">,</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$-\pi$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$-\pi/2$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$0$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\pi/2$&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\pi$&quot;</span><span class="p">))</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s2">&quot;Phase Difference&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s2">&quot;Estimated Connectivity&quot;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_dpli_wpli_pli_002.png" srcset="../_images/sphx_glr_dpli_wpli_pli_002.png" alt="Connectivity Estimation Comparison" class = "sphx-glr-single-img"/></section>
<section id="robustness-to-outliers-and-noise-with-wpli">
<h2>Robustness to Outliers and Noise with wPLI<a class="headerlink" href="#robustness-to-outliers-and-noise-with-wpli" title="Link to this heading">#</a></h2>
<p>The previous experiment illustrated the advantages conferred by dPLI when
differentiating leading and lagging phase relationships. This experiment
will now focus on understanding the advantages of wPLI, and explore how it
extends upon PLI.</p>
<p>The main difference between PLI and wPLI is in how different phase
relationships are <em>weighted</em>. In PLI, phase differences are weighted as
<span class="math notranslate nohighlight">\(-1\)</span> or <span class="math notranslate nohighlight">\(1\)</span> according to their sign. In wPLI, phase differences
are weighted based on their value, meaning that phase differences closer to
<span class="math notranslate nohighlight">\(\pm\frac{\pi}{2}\)</span> are weighted more heavily than those close to
<span class="math notranslate nohighlight">\(0\)</span> or any other multiple of <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>This avoids a discontinuity at the transition between positive and negative
phase, treating all phase differences near this transition in a similar way.
This provides some robustness against outliers and noise when estimating
connectivity. For instance, volume conduction can distort EEG/MEG recordings,
wherein signals emanating from the same neural source will be picked up by
multiple sensors on the scalp. This can effect connectivity estimations,
bringing the relative phase differences between two signals close to
<span class="math notranslate nohighlight">\(0\)</span>. wPLI minimizes the contribution of phase relationships that are
small but non-zero (and may thus be attributed to volume conduciton), while
PLI weighs these in the same way as phase relationships of
<span class="math notranslate nohighlight">\(\pm\frac{\pi}{2}\)</span>.</p>
<p>To demonstrate this, we recreate a result from (Vinck et al, 2011)
<a class="footnote-reference brackets" href="#footcite-vincketal2011" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. Two sinusoids are simulated, where the phase
difference for half of the epochs is <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span>, and is
<span class="math notranslate nohighlight">\(-\frac{\pi}{100}\)</span> for the others. We also explore the effect of
applying uniform noise to this phase difference.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_noise</span></a> <span class="o">=</span> <span class="mi">41</span>  <span class="c1"># amount of noise amplitude samples in [0, 4]</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a> <span class="o">=</span> <span class="p">[[]]</span>

<span class="c1"># Generate reference</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">_</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_e</span></a><span class="p">):</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">))</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">A_list</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_noise</span></a><span class="p">)</span>

<span class="k">for</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">A</span></a> <span class="ow">in</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">A_list</span></a><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sig</span></a> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># Generate other signal</span>
    <span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">_</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_e</span></a> <span class="o">/</span> <span class="mi">2</span><span class="p">)):</span>  <span class="c1"># phase difference -pi/100</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sig</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <a href="https://numpy.org/devdocs/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a> <span class="o">+</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">100</span> <span class="o">+</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">A</span></a> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="p">)</span>
    <span class="k">for</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">_</span></a> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_e</span></a> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_e</span></a><span class="p">):</span>  <span class="c1"># phase difference pi/2</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sig</span></a><span class="o">.</span><span class="n">append</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ufunc.html#numpy.ufunc" title="numpy.ufunc" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">sin</span></a><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">f</span></a> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a> <span class="o">-</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <a href="https://numpy.org/devdocs/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">A</span></a> <span class="o">*</span> <a href="https://numpy.org/devdocs/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sig</span></a><span class="p">)</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.swapaxes.html#numpy.swapaxes" title="numpy.swapaxes" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Visualize the data</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Reference&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><span class="mi">10</span><span class="p">])</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Phase Lagging ($-\pi/100$ Phase Difference)&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Signal&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">[:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">],</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Reference&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">t</span></a><span class="p">[:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">],</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">])</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Phase Leading ($\pi/2$ Phase Difference)&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time (s)&quot;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_dpli_wpli_pli_003.png" srcset="../_images/sphx_glr_dpli_wpli_pli_003.png" alt="Phase Lagging ($-\pi/100$ Phase Difference), Phase Leading ($\pi/2$ Phase Difference)" class = "sphx-glr-single-img"/><p>We can now compute PLI and wPLI</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a> <span class="o">=</span> <span class="p">[]</span>
<a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">indices</span></a> <span class="o">=</span> <span class="p">([</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_noise</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">n_noise</span></a> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="k">for</span> <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;pli&quot;</span><span class="p">,</span> <span class="s2">&quot;wpli&quot;</span><span class="p">]:</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span><span class="o">.</span><span class="n">append</span></a><span class="p">(</span>
        <a href="../generated/mne_connectivity.spectral_connectivity_epochs.html#mne_connectivity.spectral_connectivity_epochs" title="mne_connectivity.spectral_connectivity_epochs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-function"><span class="n">spectral_connectivity_epochs</span></a><span class="p">(</span>
            <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fs</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">indices</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#tuple" title="builtins.tuple" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">indices</span></a><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
            <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
            <span class="n">faverage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">get_data</span><span class="p">()[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.array.html#numpy.array" title="numpy.array" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">array</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Connectivity computation...
    using t=0.000s..9.996s for estimation (2500 points)
    frequencies: 9.0Hz..11.0Hz (21 points)
    connectivity scores will be averaged for each band
    computing connectivity for 41 connections
    Using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: PLI
    computing cross-spectral density for epoch 1
    computing cross-spectral density for epoch 2
    computing cross-spectral density for epoch 3
    computing cross-spectral density for epoch 4
    computing cross-spectral density for epoch 5
    computing cross-spectral density for epoch 6
    computing cross-spectral density for epoch 7
    computing cross-spectral density for epoch 8
    computing cross-spectral density for epoch 9
    computing cross-spectral density for epoch 10
    computing cross-spectral density for epoch 11
    computing cross-spectral density for epoch 12
    computing cross-spectral density for epoch 13
    computing cross-spectral density for epoch 14
    computing cross-spectral density for epoch 15
    computing cross-spectral density for epoch 16
    computing cross-spectral density for epoch 17
    computing cross-spectral density for epoch 18
    computing cross-spectral density for epoch 19
    computing cross-spectral density for epoch 20
    computing cross-spectral density for epoch 21
    computing cross-spectral density for epoch 22
    computing cross-spectral density for epoch 23
    computing cross-spectral density for epoch 24
    computing cross-spectral density for epoch 25
    computing cross-spectral density for epoch 26
    computing cross-spectral density for epoch 27
    computing cross-spectral density for epoch 28
    computing cross-spectral density for epoch 29
    computing cross-spectral density for epoch 30
    computing cross-spectral density for epoch 31
    computing cross-spectral density for epoch 32
    computing cross-spectral density for epoch 33
    computing cross-spectral density for epoch 34
    computing cross-spectral density for epoch 35
    computing cross-spectral density for epoch 36
    computing cross-spectral density for epoch 37
    computing cross-spectral density for epoch 38
    computing cross-spectral density for epoch 39
    computing cross-spectral density for epoch 40
    computing cross-spectral density for epoch 41
    computing cross-spectral density for epoch 42
    computing cross-spectral density for epoch 43
    computing cross-spectral density for epoch 44
    computing cross-spectral density for epoch 45
    computing cross-spectral density for epoch 46
    computing cross-spectral density for epoch 47
    computing cross-spectral density for epoch 48
    computing cross-spectral density for epoch 49
    computing cross-spectral density for epoch 50
    computing cross-spectral density for epoch 51
    computing cross-spectral density for epoch 52
    computing cross-spectral density for epoch 53
    computing cross-spectral density for epoch 54
    computing cross-spectral density for epoch 55
    computing cross-spectral density for epoch 56
    computing cross-spectral density for epoch 57
    computing cross-spectral density for epoch 58
    computing cross-spectral density for epoch 59
    computing cross-spectral density for epoch 60
    computing cross-spectral density for epoch 61
    computing cross-spectral density for epoch 62
    computing cross-spectral density for epoch 63
    computing cross-spectral density for epoch 64
    computing cross-spectral density for epoch 65
    computing cross-spectral density for epoch 66
    computing cross-spectral density for epoch 67
    computing cross-spectral density for epoch 68
    computing cross-spectral density for epoch 69
    computing cross-spectral density for epoch 70
    computing cross-spectral density for epoch 71
    computing cross-spectral density for epoch 72
    computing cross-spectral density for epoch 73
    computing cross-spectral density for epoch 74
    computing cross-spectral density for epoch 75
    computing cross-spectral density for epoch 76
    computing cross-spectral density for epoch 77
    computing cross-spectral density for epoch 78
    computing cross-spectral density for epoch 79
    computing cross-spectral density for epoch 80
    computing cross-spectral density for epoch 81
    computing cross-spectral density for epoch 82
    computing cross-spectral density for epoch 83
    computing cross-spectral density for epoch 84
    computing cross-spectral density for epoch 85
    computing cross-spectral density for epoch 86
    computing cross-spectral density for epoch 87
    computing cross-spectral density for epoch 88
    computing cross-spectral density for epoch 89
    computing cross-spectral density for epoch 90
    computing cross-spectral density for epoch 91
    computing cross-spectral density for epoch 92
    computing cross-spectral density for epoch 93
    computing cross-spectral density for epoch 94
    computing cross-spectral density for epoch 95
    computing cross-spectral density for epoch 96
    computing cross-spectral density for epoch 97
    computing cross-spectral density for epoch 98
    computing cross-spectral density for epoch 99
    computing cross-spectral density for epoch 100
    computing cross-spectral density for epoch 101
    computing cross-spectral density for epoch 102
    computing cross-spectral density for epoch 103
    computing cross-spectral density for epoch 104
    computing cross-spectral density for epoch 105
    computing cross-spectral density for epoch 106
    computing cross-spectral density for epoch 107
    computing cross-spectral density for epoch 108
    computing cross-spectral density for epoch 109
    computing cross-spectral density for epoch 110
    computing cross-spectral density for epoch 111
    computing cross-spectral density for epoch 112
    computing cross-spectral density for epoch 113
    computing cross-spectral density for epoch 114
    computing cross-spectral density for epoch 115
    computing cross-spectral density for epoch 116
    computing cross-spectral density for epoch 117
    computing cross-spectral density for epoch 118
    computing cross-spectral density for epoch 119
    computing cross-spectral density for epoch 120
    computing cross-spectral density for epoch 121
    computing cross-spectral density for epoch 122
    computing cross-spectral density for epoch 123
    computing cross-spectral density for epoch 124
    computing cross-spectral density for epoch 125
    computing cross-spectral density for epoch 126
    computing cross-spectral density for epoch 127
    computing cross-spectral density for epoch 128
    computing cross-spectral density for epoch 129
    computing cross-spectral density for epoch 130
    computing cross-spectral density for epoch 131
    computing cross-spectral density for epoch 132
    computing cross-spectral density for epoch 133
    computing cross-spectral density for epoch 134
    computing cross-spectral density for epoch 135
    computing cross-spectral density for epoch 136
    computing cross-spectral density for epoch 137
    computing cross-spectral density for epoch 138
    computing cross-spectral density for epoch 139
    computing cross-spectral density for epoch 140
    computing cross-spectral density for epoch 141
    computing cross-spectral density for epoch 142
    computing cross-spectral density for epoch 143
    computing cross-spectral density for epoch 144
    computing cross-spectral density for epoch 145
    computing cross-spectral density for epoch 146
    computing cross-spectral density for epoch 147
    computing cross-spectral density for epoch 148
    computing cross-spectral density for epoch 149
    computing cross-spectral density for epoch 150
    computing cross-spectral density for epoch 151
    computing cross-spectral density for epoch 152
    computing cross-spectral density for epoch 153
    computing cross-spectral density for epoch 154
    computing cross-spectral density for epoch 155
    computing cross-spectral density for epoch 156
    computing cross-spectral density for epoch 157
    computing cross-spectral density for epoch 158
    computing cross-spectral density for epoch 159
    computing cross-spectral density for epoch 160
    computing cross-spectral density for epoch 161
    computing cross-spectral density for epoch 162
    computing cross-spectral density for epoch 163
    computing cross-spectral density for epoch 164
    computing cross-spectral density for epoch 165
    computing cross-spectral density for epoch 166
    computing cross-spectral density for epoch 167
    computing cross-spectral density for epoch 168
    computing cross-spectral density for epoch 169
    computing cross-spectral density for epoch 170
    computing cross-spectral density for epoch 171
    computing cross-spectral density for epoch 172
    computing cross-spectral density for epoch 173
    computing cross-spectral density for epoch 174
    computing cross-spectral density for epoch 175
    computing cross-spectral density for epoch 176
    computing cross-spectral density for epoch 177
    computing cross-spectral density for epoch 178
    computing cross-spectral density for epoch 179
    computing cross-spectral density for epoch 180
    computing cross-spectral density for epoch 181
    computing cross-spectral density for epoch 182
    computing cross-spectral density for epoch 183
    computing cross-spectral density for epoch 184
    computing cross-spectral density for epoch 185
    computing cross-spectral density for epoch 186
    computing cross-spectral density for epoch 187
    computing cross-spectral density for epoch 188
    computing cross-spectral density for epoch 189
    computing cross-spectral density for epoch 190
    computing cross-spectral density for epoch 191
    computing cross-spectral density for epoch 192
    computing cross-spectral density for epoch 193
    computing cross-spectral density for epoch 194
    computing cross-spectral density for epoch 195
    computing cross-spectral density for epoch 196
    computing cross-spectral density for epoch 197
    computing cross-spectral density for epoch 198
    computing cross-spectral density for epoch 199
    computing cross-spectral density for epoch 200
    computing cross-spectral density for epoch 201
    computing cross-spectral density for epoch 202
    computing cross-spectral density for epoch 203
    computing cross-spectral density for epoch 204
    computing cross-spectral density for epoch 205
    computing cross-spectral density for epoch 206
    computing cross-spectral density for epoch 207
    computing cross-spectral density for epoch 208
    computing cross-spectral density for epoch 209
    computing cross-spectral density for epoch 210
    computing cross-spectral density for epoch 211
    computing cross-spectral density for epoch 212
    computing cross-spectral density for epoch 213
    computing cross-spectral density for epoch 214
    computing cross-spectral density for epoch 215
    computing cross-spectral density for epoch 216
    computing cross-spectral density for epoch 217
    computing cross-spectral density for epoch 218
    computing cross-spectral density for epoch 219
    computing cross-spectral density for epoch 220
    computing cross-spectral density for epoch 221
    computing cross-spectral density for epoch 222
    computing cross-spectral density for epoch 223
    computing cross-spectral density for epoch 224
    computing cross-spectral density for epoch 225
    computing cross-spectral density for epoch 226
    computing cross-spectral density for epoch 227
    computing cross-spectral density for epoch 228
    computing cross-spectral density for epoch 229
    computing cross-spectral density for epoch 230
    computing cross-spectral density for epoch 231
    computing cross-spectral density for epoch 232
    computing cross-spectral density for epoch 233
    computing cross-spectral density for epoch 234
    computing cross-spectral density for epoch 235
    computing cross-spectral density for epoch 236
    computing cross-spectral density for epoch 237
    computing cross-spectral density for epoch 238
    computing cross-spectral density for epoch 239
    computing cross-spectral density for epoch 240
    computing cross-spectral density for epoch 241
    computing cross-spectral density for epoch 242
    computing cross-spectral density for epoch 243
    computing cross-spectral density for epoch 244
    computing cross-spectral density for epoch 245
    computing cross-spectral density for epoch 246
    computing cross-spectral density for epoch 247
    computing cross-spectral density for epoch 248
    computing cross-spectral density for epoch 249
    computing cross-spectral density for epoch 250
    computing cross-spectral density for epoch 251
    computing cross-spectral density for epoch 252
    computing cross-spectral density for epoch 253
    computing cross-spectral density for epoch 254
    computing cross-spectral density for epoch 255
    computing cross-spectral density for epoch 256
    computing cross-spectral density for epoch 257
    computing cross-spectral density for epoch 258
    computing cross-spectral density for epoch 259
    computing cross-spectral density for epoch 260
    computing cross-spectral density for epoch 261
    computing cross-spectral density for epoch 262
    computing cross-spectral density for epoch 263
    computing cross-spectral density for epoch 264
    computing cross-spectral density for epoch 265
    computing cross-spectral density for epoch 266
    computing cross-spectral density for epoch 267
    computing cross-spectral density for epoch 268
    computing cross-spectral density for epoch 269
    computing cross-spectral density for epoch 270
    computing cross-spectral density for epoch 271
    computing cross-spectral density for epoch 272
    computing cross-spectral density for epoch 273
    computing cross-spectral density for epoch 274
    computing cross-spectral density for epoch 275
    computing cross-spectral density for epoch 276
    computing cross-spectral density for epoch 277
    computing cross-spectral density for epoch 278
    computing cross-spectral density for epoch 279
    computing cross-spectral density for epoch 280
    computing cross-spectral density for epoch 281
    computing cross-spectral density for epoch 282
    computing cross-spectral density for epoch 283
    computing cross-spectral density for epoch 284
    computing cross-spectral density for epoch 285
    computing cross-spectral density for epoch 286
    computing cross-spectral density for epoch 287
    computing cross-spectral density for epoch 288
    computing cross-spectral density for epoch 289
    computing cross-spectral density for epoch 290
    computing cross-spectral density for epoch 291
    computing cross-spectral density for epoch 292
    computing cross-spectral density for epoch 293
    computing cross-spectral density for epoch 294
    computing cross-spectral density for epoch 295
    computing cross-spectral density for epoch 296
    computing cross-spectral density for epoch 297
    computing cross-spectral density for epoch 298
    computing cross-spectral density for epoch 299
    computing cross-spectral density for epoch 300
[Connectivity computation done]
Connectivity computation...
    using t=0.000s..9.996s for estimation (2500 points)
    frequencies: 9.0Hz..11.0Hz (21 points)
    connectivity scores will be averaged for each band
    computing connectivity for 41 connections
    Using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: WPLI
    computing cross-spectral density for epoch 1
    computing cross-spectral density for epoch 2
    computing cross-spectral density for epoch 3
    computing cross-spectral density for epoch 4
    computing cross-spectral density for epoch 5
    computing cross-spectral density for epoch 6
    computing cross-spectral density for epoch 7
    computing cross-spectral density for epoch 8
    computing cross-spectral density for epoch 9
    computing cross-spectral density for epoch 10
    computing cross-spectral density for epoch 11
    computing cross-spectral density for epoch 12
    computing cross-spectral density for epoch 13
    computing cross-spectral density for epoch 14
    computing cross-spectral density for epoch 15
    computing cross-spectral density for epoch 16
    computing cross-spectral density for epoch 17
    computing cross-spectral density for epoch 18
    computing cross-spectral density for epoch 19
    computing cross-spectral density for epoch 20
    computing cross-spectral density for epoch 21
    computing cross-spectral density for epoch 22
    computing cross-spectral density for epoch 23
    computing cross-spectral density for epoch 24
    computing cross-spectral density for epoch 25
    computing cross-spectral density for epoch 26
    computing cross-spectral density for epoch 27
    computing cross-spectral density for epoch 28
    computing cross-spectral density for epoch 29
    computing cross-spectral density for epoch 30
    computing cross-spectral density for epoch 31
    computing cross-spectral density for epoch 32
    computing cross-spectral density for epoch 33
    computing cross-spectral density for epoch 34
    computing cross-spectral density for epoch 35
    computing cross-spectral density for epoch 36
    computing cross-spectral density for epoch 37
    computing cross-spectral density for epoch 38
    computing cross-spectral density for epoch 39
    computing cross-spectral density for epoch 40
    computing cross-spectral density for epoch 41
    computing cross-spectral density for epoch 42
    computing cross-spectral density for epoch 43
    computing cross-spectral density for epoch 44
    computing cross-spectral density for epoch 45
    computing cross-spectral density for epoch 46
    computing cross-spectral density for epoch 47
    computing cross-spectral density for epoch 48
    computing cross-spectral density for epoch 49
    computing cross-spectral density for epoch 50
    computing cross-spectral density for epoch 51
    computing cross-spectral density for epoch 52
    computing cross-spectral density for epoch 53
    computing cross-spectral density for epoch 54
    computing cross-spectral density for epoch 55
    computing cross-spectral density for epoch 56
    computing cross-spectral density for epoch 57
    computing cross-spectral density for epoch 58
    computing cross-spectral density for epoch 59
    computing cross-spectral density for epoch 60
    computing cross-spectral density for epoch 61
    computing cross-spectral density for epoch 62
    computing cross-spectral density for epoch 63
    computing cross-spectral density for epoch 64
    computing cross-spectral density for epoch 65
    computing cross-spectral density for epoch 66
    computing cross-spectral density for epoch 67
    computing cross-spectral density for epoch 68
    computing cross-spectral density for epoch 69
    computing cross-spectral density for epoch 70
    computing cross-spectral density for epoch 71
    computing cross-spectral density for epoch 72
    computing cross-spectral density for epoch 73
    computing cross-spectral density for epoch 74
    computing cross-spectral density for epoch 75
    computing cross-spectral density for epoch 76
    computing cross-spectral density for epoch 77
    computing cross-spectral density for epoch 78
    computing cross-spectral density for epoch 79
    computing cross-spectral density for epoch 80
    computing cross-spectral density for epoch 81
    computing cross-spectral density for epoch 82
    computing cross-spectral density for epoch 83
    computing cross-spectral density for epoch 84
    computing cross-spectral density for epoch 85
    computing cross-spectral density for epoch 86
    computing cross-spectral density for epoch 87
    computing cross-spectral density for epoch 88
    computing cross-spectral density for epoch 89
    computing cross-spectral density for epoch 90
    computing cross-spectral density for epoch 91
    computing cross-spectral density for epoch 92
    computing cross-spectral density for epoch 93
    computing cross-spectral density for epoch 94
    computing cross-spectral density for epoch 95
    computing cross-spectral density for epoch 96
    computing cross-spectral density for epoch 97
    computing cross-spectral density for epoch 98
    computing cross-spectral density for epoch 99
    computing cross-spectral density for epoch 100
    computing cross-spectral density for epoch 101
    computing cross-spectral density for epoch 102
    computing cross-spectral density for epoch 103
    computing cross-spectral density for epoch 104
    computing cross-spectral density for epoch 105
    computing cross-spectral density for epoch 106
    computing cross-spectral density for epoch 107
    computing cross-spectral density for epoch 108
    computing cross-spectral density for epoch 109
    computing cross-spectral density for epoch 110
    computing cross-spectral density for epoch 111
    computing cross-spectral density for epoch 112
    computing cross-spectral density for epoch 113
    computing cross-spectral density for epoch 114
    computing cross-spectral density for epoch 115
    computing cross-spectral density for epoch 116
    computing cross-spectral density for epoch 117
    computing cross-spectral density for epoch 118
    computing cross-spectral density for epoch 119
    computing cross-spectral density for epoch 120
    computing cross-spectral density for epoch 121
    computing cross-spectral density for epoch 122
    computing cross-spectral density for epoch 123
    computing cross-spectral density for epoch 124
    computing cross-spectral density for epoch 125
    computing cross-spectral density for epoch 126
    computing cross-spectral density for epoch 127
    computing cross-spectral density for epoch 128
    computing cross-spectral density for epoch 129
    computing cross-spectral density for epoch 130
    computing cross-spectral density for epoch 131
    computing cross-spectral density for epoch 132
    computing cross-spectral density for epoch 133
    computing cross-spectral density for epoch 134
    computing cross-spectral density for epoch 135
    computing cross-spectral density for epoch 136
    computing cross-spectral density for epoch 137
    computing cross-spectral density for epoch 138
    computing cross-spectral density for epoch 139
    computing cross-spectral density for epoch 140
    computing cross-spectral density for epoch 141
    computing cross-spectral density for epoch 142
    computing cross-spectral density for epoch 143
    computing cross-spectral density for epoch 144
    computing cross-spectral density for epoch 145
    computing cross-spectral density for epoch 146
    computing cross-spectral density for epoch 147
    computing cross-spectral density for epoch 148
    computing cross-spectral density for epoch 149
    computing cross-spectral density for epoch 150
    computing cross-spectral density for epoch 151
    computing cross-spectral density for epoch 152
    computing cross-spectral density for epoch 153
    computing cross-spectral density for epoch 154
    computing cross-spectral density for epoch 155
    computing cross-spectral density for epoch 156
    computing cross-spectral density for epoch 157
    computing cross-spectral density for epoch 158
    computing cross-spectral density for epoch 159
    computing cross-spectral density for epoch 160
    computing cross-spectral density for epoch 161
    computing cross-spectral density for epoch 162
    computing cross-spectral density for epoch 163
    computing cross-spectral density for epoch 164
    computing cross-spectral density for epoch 165
    computing cross-spectral density for epoch 166
    computing cross-spectral density for epoch 167
    computing cross-spectral density for epoch 168
    computing cross-spectral density for epoch 169
    computing cross-spectral density for epoch 170
    computing cross-spectral density for epoch 171
    computing cross-spectral density for epoch 172
    computing cross-spectral density for epoch 173
    computing cross-spectral density for epoch 174
    computing cross-spectral density for epoch 175
    computing cross-spectral density for epoch 176
    computing cross-spectral density for epoch 177
    computing cross-spectral density for epoch 178
    computing cross-spectral density for epoch 179
    computing cross-spectral density for epoch 180
    computing cross-spectral density for epoch 181
    computing cross-spectral density for epoch 182
    computing cross-spectral density for epoch 183
    computing cross-spectral density for epoch 184
    computing cross-spectral density for epoch 185
    computing cross-spectral density for epoch 186
    computing cross-spectral density for epoch 187
    computing cross-spectral density for epoch 188
    computing cross-spectral density for epoch 189
    computing cross-spectral density for epoch 190
    computing cross-spectral density for epoch 191
    computing cross-spectral density for epoch 192
    computing cross-spectral density for epoch 193
    computing cross-spectral density for epoch 194
    computing cross-spectral density for epoch 195
    computing cross-spectral density for epoch 196
    computing cross-spectral density for epoch 197
    computing cross-spectral density for epoch 198
    computing cross-spectral density for epoch 199
    computing cross-spectral density for epoch 200
    computing cross-spectral density for epoch 201
    computing cross-spectral density for epoch 202
    computing cross-spectral density for epoch 203
    computing cross-spectral density for epoch 204
    computing cross-spectral density for epoch 205
    computing cross-spectral density for epoch 206
    computing cross-spectral density for epoch 207
    computing cross-spectral density for epoch 208
    computing cross-spectral density for epoch 209
    computing cross-spectral density for epoch 210
    computing cross-spectral density for epoch 211
    computing cross-spectral density for epoch 212
    computing cross-spectral density for epoch 213
    computing cross-spectral density for epoch 214
    computing cross-spectral density for epoch 215
    computing cross-spectral density for epoch 216
    computing cross-spectral density for epoch 217
    computing cross-spectral density for epoch 218
    computing cross-spectral density for epoch 219
    computing cross-spectral density for epoch 220
    computing cross-spectral density for epoch 221
    computing cross-spectral density for epoch 222
    computing cross-spectral density for epoch 223
    computing cross-spectral density for epoch 224
    computing cross-spectral density for epoch 225
    computing cross-spectral density for epoch 226
    computing cross-spectral density for epoch 227
    computing cross-spectral density for epoch 228
    computing cross-spectral density for epoch 229
    computing cross-spectral density for epoch 230
    computing cross-spectral density for epoch 231
    computing cross-spectral density for epoch 232
    computing cross-spectral density for epoch 233
    computing cross-spectral density for epoch 234
    computing cross-spectral density for epoch 235
    computing cross-spectral density for epoch 236
    computing cross-spectral density for epoch 237
    computing cross-spectral density for epoch 238
    computing cross-spectral density for epoch 239
    computing cross-spectral density for epoch 240
    computing cross-spectral density for epoch 241
    computing cross-spectral density for epoch 242
    computing cross-spectral density for epoch 243
    computing cross-spectral density for epoch 244
    computing cross-spectral density for epoch 245
    computing cross-spectral density for epoch 246
    computing cross-spectral density for epoch 247
    computing cross-spectral density for epoch 248
    computing cross-spectral density for epoch 249
    computing cross-spectral density for epoch 250
    computing cross-spectral density for epoch 251
    computing cross-spectral density for epoch 252
    computing cross-spectral density for epoch 253
    computing cross-spectral density for epoch 254
    computing cross-spectral density for epoch 255
    computing cross-spectral density for epoch 256
    computing cross-spectral density for epoch 257
    computing cross-spectral density for epoch 258
    computing cross-spectral density for epoch 259
    computing cross-spectral density for epoch 260
    computing cross-spectral density for epoch 261
    computing cross-spectral density for epoch 262
    computing cross-spectral density for epoch 263
    computing cross-spectral density for epoch 264
    computing cross-spectral density for epoch 265
    computing cross-spectral density for epoch 266
    computing cross-spectral density for epoch 267
    computing cross-spectral density for epoch 268
    computing cross-spectral density for epoch 269
    computing cross-spectral density for epoch 270
    computing cross-spectral density for epoch 271
    computing cross-spectral density for epoch 272
    computing cross-spectral density for epoch 273
    computing cross-spectral density for epoch 274
    computing cross-spectral density for epoch 275
    computing cross-spectral density for epoch 276
    computing cross-spectral density for epoch 277
    computing cross-spectral density for epoch 278
    computing cross-spectral density for epoch 279
    computing cross-spectral density for epoch 280
    computing cross-spectral density for epoch 281
    computing cross-spectral density for epoch 282
    computing cross-spectral density for epoch 283
    computing cross-spectral density for epoch 284
    computing cross-spectral density for epoch 285
    computing cross-spectral density for epoch 286
    computing cross-spectral density for epoch 287
    computing cross-spectral density for epoch 288
    computing cross-spectral density for epoch 289
    computing cross-spectral density for epoch 290
    computing cross-spectral density for epoch 291
    computing cross-spectral density for epoch 292
    computing cross-spectral density for epoch 293
    computing cross-spectral density for epoch 294
    computing cross-spectral density for epoch 295
    computing cross-spectral density for epoch 296
    computing cross-spectral density for epoch 297
    computing cross-spectral density for epoch 298
    computing cross-spectral density for epoch 299
    computing cross-spectral density for epoch 300
[Connectivity computation done]
</pre></div>
</div>
<p>The results from the simulation are shown in the figure below. In the case
without noise, the difference between wPLI and PLI is made obvious. In PLI,
no connectivity is detected, as the <span class="math notranslate nohighlight">\(-\frac{\pi}{100}\)</span> phase
differences are weighted in the exact same way as the <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span>
relationships. wPLI is able to avoid the cancellation of the
<span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span> relationships.</p>
<p>As noise gets added, PLI increases since the <span class="math notranslate nohighlight">\(-\frac{\pi}{100}\)</span>
relationships are made positive more often than the <span class="math notranslate nohighlight">\(\frac{\pi}{2}\)</span>
relationships are made negative. However, wPLI maintains an advantage in
its ability to distinguish the underlying structure. Beyond a certain point,
the noise dominates any pre-defined structure, and both methods behave
similarly, tending toward <span class="math notranslate nohighlight">\(0\)</span>. For a more detailed analysis of this
result and the properties of wPLI, please refer to (Vinck et al, 2011)
<a class="footnote-reference brackets" href="#footcite-vincketal2011" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.figure.html#matplotlib.pyplot.figure" title="matplotlib.pyplot.figure" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">figure</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">A_list</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;o-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;PLI&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="matplotlib.pyplot.plot" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">A_list</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">conn</span></a><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;o-&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;wPLI&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="matplotlib.pyplot.legend" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">legend</span></a><span class="p">()</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.xlabel.html#matplotlib.pyplot.xlabel" title="matplotlib.pyplot.xlabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span></a><span class="p">(</span><span class="s2">&quot;Noise Amplitude&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.ylabel.html#matplotlib.pyplot.ylabel" title="matplotlib.pyplot.ylabel" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span></a><span class="p">(</span><span class="s2">&quot;Connectivity Measure&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.title.html#matplotlib.pyplot.title" title="matplotlib.pyplot.title" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">title</span></a><span class="p">(</span><span class="s2">&quot;wPLI and PLI Under Increasing Noise&quot;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_dpli_wpli_pli_004.png" srcset="../_images/sphx_glr_dpli_wpli_pli_004.png" alt="wPLI and PLI Under Increasing Noise" class = "sphx-glr-single-img"/></section>
<section id="demo-on-meg-data">
<h2>Demo On MEG Data<a class="headerlink" href="#demo-on-meg-data" title="Link to this heading">#</a></h2>
<p>To finish this example, we also quickly demonstrate these methods on some
sample MEG data recorded during visual stimulation.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.datasets.sample.data_path.html#mne.datasets.sample.data_path" title="mne.datasets.sample.data_path" class="sphx-glr-backref-module-mne-datasets-sample sphx-glr-backref-type-py-function"><span class="n">sample</span><span class="o">.</span><span class="n">data_path</span></a><span class="p">()</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">/</span> <span class="s2">&quot;MEG/sample/sample_audvis_filt-0-40_raw.fif&quot;</span>
<a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_fname</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data_path</span></a> <span class="o">/</span> <span class="s2">&quot;MEG/sample/sample_audvis_filt-0-40_raw-eve.fif&quot;</span>
<a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.io.read_raw_fif.html#mne.io.read_raw_fif" title="mne.io.read_raw_fif" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">read_raw_fif</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw_fname</span></a><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.read_events.html#mne.read_events" title="mne.read_events" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">read_events</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.PosixPath" title="pathlib.PosixPath" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_fname</span></a><span class="p">)</span>


<span class="c1"># Select gradiometers</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.pick_types.html#mne.pick_types" title="mne.pick_types" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-function"><span class="n">mne</span><span class="o">.</span><span class="n">pick_types</span></a><span class="p">(</span>
    <a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">,</span> <span class="n">meg</span><span class="o">=</span><span class="s2">&quot;grad&quot;</span><span class="p">,</span> <span class="n">eeg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">stim</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exclude</span><span class="o">=</span><span class="s2">&quot;bads&quot;</span>
<span class="p">)</span>

<span class="c1"># Create epochs</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.5</span>  <span class="c1"># need a long enough epoch for 5 cycles</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class"><span class="n">mne</span><span class="o">.</span><span class="n">Epochs</span></a><span class="p">(</span>
    <a href="https://mne.tools/dev/generated/mne.io.Raw.html#mne.io.Raw" title="mne.io.Raw" class="sphx-glr-backref-module-mne-io sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span></a><span class="p">,</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">events</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">event_id</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmax</span></a><span class="p">,</span>
    <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">picks</span></a><span class="p">,</span>
    <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="n">reject</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">grad</span><span class="o">=</span><span class="mf">4000e-13</span><span class="p">,</span> <span class="n">eog</span><span class="o">=</span><span class="mf">150e-6</span><span class="p">),</span>
<span class="p">)</span>
<a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs.load_data" title="mne.Epochs.load_data" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-method"><span class="n">epochs</span><span class="o">.</span><span class="n">load_data</span></a><span class="p">()</span><span class="o">.</span><span class="n">pick_types</span><span class="p">(</span><span class="n">meg</span><span class="o">=</span><span class="s2">&quot;grad&quot;</span><span class="p">)</span>  <span class="c1"># just keep MEG and no EOG now</span>

<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a> <span class="o">=</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">9.0</span>  <span class="c1"># compute connectivity within 4-9 Hz</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a> <span class="o">=</span> <a href="https://mne.tools/dev/generated/mne.Info.html#mne.Info" title="mne._fiff.meas_info.Info" class="sphx-glr-backref-module-mne-_fiff-meas_info sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">raw</span><span class="o">.</span><span class="n">info</span></a><span class="p">[</span><span class="s2">&quot;sfreq&quot;</span><span class="p">]</span>  <span class="c1"># the sampling frequency</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># exclude the baseline period</span>

<span class="c1"># Compute PLI, wPLI, and dPLI</span>
<a href="../generated/mne_connectivity.SpectralConnectivity.html#mne_connectivity.SpectralConnectivity" title="mne_connectivity.SpectralConnectivity" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">con_pli</span></a> <span class="o">=</span> <a href="../generated/mne_connectivity.spectral_connectivity_epochs.html#mne_connectivity.spectral_connectivity_epochs" title="mne_connectivity.spectral_connectivity_epochs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-function"><span class="n">spectral_connectivity_epochs</span></a><span class="p">(</span>
    <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><span class="s2">&quot;pli&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;multitaper&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="p">,</span>
    <span class="n">faverage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span>
    <span class="n">mt_adaptive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<a href="../generated/mne_connectivity.SpectralConnectivity.html#mne_connectivity.SpectralConnectivity" title="mne_connectivity.SpectralConnectivity" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">con_wpli</span></a> <span class="o">=</span> <a href="../generated/mne_connectivity.spectral_connectivity_epochs.html#mne_connectivity.spectral_connectivity_epochs" title="mne_connectivity.spectral_connectivity_epochs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-function"><span class="n">spectral_connectivity_epochs</span></a><span class="p">(</span>
    <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><span class="s2">&quot;wpli&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;multitaper&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="p">,</span>
    <span class="n">faverage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span>
    <span class="n">mt_adaptive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>

<a href="../generated/mne_connectivity.SpectralConnectivity.html#mne_connectivity.SpectralConnectivity" title="mne_connectivity.SpectralConnectivity" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">con_dpli</span></a> <span class="o">=</span> <a href="../generated/mne_connectivity.spectral_connectivity_epochs.html#mne_connectivity.spectral_connectivity_epochs" title="mne_connectivity.spectral_connectivity_epochs" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-function"><span class="n">spectral_connectivity_epochs</span></a><span class="p">(</span>
    <a href="https://mne.tools/dev/generated/mne.Epochs.html#mne.Epochs" title="mne.Epochs" class="sphx-glr-backref-module-mne sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">epochs</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">method</span></a><span class="o">=</span><span class="s2">&quot;dpli&quot;</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;multitaper&quot;</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sfreq</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmin</span></a><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fmax</span></a><span class="p">,</span>
    <span class="n">faverage</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">tmin</span></a><span class="p">,</span>
    <span class="n">mt_adaptive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">n_jobs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Opening raw data file /home/circleci/mne_data/MNE-sample-data/MEG/sample/sample_audvis_filt-0-40_raw.fif...
    Read a total of 4 projection items:
        PCA-v1 (1 x 102)  idle
        PCA-v2 (1 x 102)  idle
        PCA-v3 (1 x 102)  idle
        Average EEG reference (1 x 60)  idle
    Range : 6450 ... 48149 =     42.956 ...   320.665 secs
Ready.
Not setting metadata
73 matching events found
Setting baseline interval to [-0.19979521315838786, 0.0] s
Applying baseline correction (mode: mean)
0 projection items activated
Loading data for 73 events and 256 original time points ...
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
    Rejecting  epoch based on EOG : [&#39;EOG 061&#39;]
24 bad epochs dropped
NOTE: pick_types() is a legacy function. New code should use inst.pick(...).
Adding metadata with 3 columns
Connectivity computation...
    using t=0.000s..1.498s for estimation (226 points)
    frequencies: 4.7Hz..8.6Hz (7 points)
    connectivity scores will be averaged for each band
only using indices for lower-triangular matrix
    computing connectivity for 20503 connections
    Using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: PLI
    computing cross-spectral density for epoch 1
    computing cross-spectral density for epoch 2
    computing cross-spectral density for epoch 3
    computing cross-spectral density for epoch 4
    computing cross-spectral density for epoch 5
    computing cross-spectral density for epoch 6
    computing cross-spectral density for epoch 7
    computing cross-spectral density for epoch 8
    computing cross-spectral density for epoch 9
    computing cross-spectral density for epoch 10
    computing cross-spectral density for epoch 11
    computing cross-spectral density for epoch 12
    computing cross-spectral density for epoch 13
    computing cross-spectral density for epoch 14
    computing cross-spectral density for epoch 15
    computing cross-spectral density for epoch 16
    computing cross-spectral density for epoch 17
    computing cross-spectral density for epoch 18
    computing cross-spectral density for epoch 19
    computing cross-spectral density for epoch 20
    computing cross-spectral density for epoch 21
    computing cross-spectral density for epoch 22
    computing cross-spectral density for epoch 23
    computing cross-spectral density for epoch 24
    computing cross-spectral density for epoch 25
    computing cross-spectral density for epoch 26
    computing cross-spectral density for epoch 27
    computing cross-spectral density for epoch 28
    computing cross-spectral density for epoch 29
    computing cross-spectral density for epoch 30
    computing cross-spectral density for epoch 31
    computing cross-spectral density for epoch 32
    computing cross-spectral density for epoch 33
    computing cross-spectral density for epoch 34
    computing cross-spectral density for epoch 35
    computing cross-spectral density for epoch 36
    computing cross-spectral density for epoch 37
    computing cross-spectral density for epoch 38
    computing cross-spectral density for epoch 39
    computing cross-spectral density for epoch 40
    computing cross-spectral density for epoch 41
    computing cross-spectral density for epoch 42
    computing cross-spectral density for epoch 43
    computing cross-spectral density for epoch 44
    computing cross-spectral density for epoch 45
    computing cross-spectral density for epoch 46
    computing cross-spectral density for epoch 47
    computing cross-spectral density for epoch 48
    computing cross-spectral density for epoch 49
    assembling connectivity matrix
[Connectivity computation done]
Replacing existing metadata with 3 columns
Connectivity computation...
    using t=0.000s..1.498s for estimation (226 points)
    frequencies: 4.7Hz..8.6Hz (7 points)
    connectivity scores will be averaged for each band
only using indices for lower-triangular matrix
    computing connectivity for 20503 connections
    Using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: WPLI
    computing cross-spectral density for epoch 1
    computing cross-spectral density for epoch 2
    computing cross-spectral density for epoch 3
    computing cross-spectral density for epoch 4
    computing cross-spectral density for epoch 5
    computing cross-spectral density for epoch 6
    computing cross-spectral density for epoch 7
    computing cross-spectral density for epoch 8
    computing cross-spectral density for epoch 9
    computing cross-spectral density for epoch 10
    computing cross-spectral density for epoch 11
    computing cross-spectral density for epoch 12
    computing cross-spectral density for epoch 13
    computing cross-spectral density for epoch 14
    computing cross-spectral density for epoch 15
    computing cross-spectral density for epoch 16
    computing cross-spectral density for epoch 17
    computing cross-spectral density for epoch 18
    computing cross-spectral density for epoch 19
    computing cross-spectral density for epoch 20
    computing cross-spectral density for epoch 21
    computing cross-spectral density for epoch 22
    computing cross-spectral density for epoch 23
    computing cross-spectral density for epoch 24
    computing cross-spectral density for epoch 25
    computing cross-spectral density for epoch 26
    computing cross-spectral density for epoch 27
    computing cross-spectral density for epoch 28
    computing cross-spectral density for epoch 29
    computing cross-spectral density for epoch 30
    computing cross-spectral density for epoch 31
    computing cross-spectral density for epoch 32
    computing cross-spectral density for epoch 33
    computing cross-spectral density for epoch 34
    computing cross-spectral density for epoch 35
    computing cross-spectral density for epoch 36
    computing cross-spectral density for epoch 37
    computing cross-spectral density for epoch 38
    computing cross-spectral density for epoch 39
    computing cross-spectral density for epoch 40
    computing cross-spectral density for epoch 41
    computing cross-spectral density for epoch 42
    computing cross-spectral density for epoch 43
    computing cross-spectral density for epoch 44
    computing cross-spectral density for epoch 45
    computing cross-spectral density for epoch 46
    computing cross-spectral density for epoch 47
    computing cross-spectral density for epoch 48
    computing cross-spectral density for epoch 49
    assembling connectivity matrix
[Connectivity computation done]
Replacing existing metadata with 3 columns
Connectivity computation...
    using t=0.000s..1.498s for estimation (226 points)
    frequencies: 4.7Hz..8.6Hz (7 points)
    connectivity scores will be averaged for each band
only using indices for lower-triangular matrix
    computing connectivity for 20503 connections
    Using multitaper spectrum estimation with 7 DPSS windows
    the following metrics will be computed: DPLI
    computing cross-spectral density for epoch 1
    computing cross-spectral density for epoch 2
    computing cross-spectral density for epoch 3
    computing cross-spectral density for epoch 4
    computing cross-spectral density for epoch 5
    computing cross-spectral density for epoch 6
    computing cross-spectral density for epoch 7
    computing cross-spectral density for epoch 8
    computing cross-spectral density for epoch 9
    computing cross-spectral density for epoch 10
    computing cross-spectral density for epoch 11
    computing cross-spectral density for epoch 12
    computing cross-spectral density for epoch 13
    computing cross-spectral density for epoch 14
    computing cross-spectral density for epoch 15
    computing cross-spectral density for epoch 16
    computing cross-spectral density for epoch 17
    computing cross-spectral density for epoch 18
    computing cross-spectral density for epoch 19
    computing cross-spectral density for epoch 20
    computing cross-spectral density for epoch 21
    computing cross-spectral density for epoch 22
    computing cross-spectral density for epoch 23
    computing cross-spectral density for epoch 24
    computing cross-spectral density for epoch 25
    computing cross-spectral density for epoch 26
    computing cross-spectral density for epoch 27
    computing cross-spectral density for epoch 28
    computing cross-spectral density for epoch 29
    computing cross-spectral density for epoch 30
    computing cross-spectral density for epoch 31
    computing cross-spectral density for epoch 32
    computing cross-spectral density for epoch 33
    computing cross-spectral density for epoch 34
    computing cross-spectral density for epoch 35
    computing cross-spectral density for epoch 36
    computing cross-spectral density for epoch 37
    computing cross-spectral density for epoch 38
    computing cross-spectral density for epoch 39
    computing cross-spectral density for epoch 40
    computing cross-spectral density for epoch 41
    computing cross-spectral density for epoch 42
    computing cross-spectral density for epoch 43
    computing cross-spectral density for epoch 44
    computing cross-spectral density for epoch 45
    computing cross-spectral density for epoch 46
    computing cross-spectral density for epoch 47
    computing cross-spectral density for epoch 48
    computing cross-spectral density for epoch 49
    assembling connectivity matrix
[Connectivity computation done]
</pre></div>
</div>
<p>In this example, there is strong connectivity between sensors 190-200 and
sensors 110-160.</p>
<p>Moreover, after observing the presence of connectivity, dPLI can be used to
ascertain the direction of the phase relationship. Here, it appears that the
dPLI connectivity in this area is less than <span class="math notranslate nohighlight">\(0.5\)</span>, and thus sensors
190-200 are lagging sensors 110-160.</p>
<p>In keeping with the previous simulation, we can see that wPLI identifies
stronger connectivity relationships than PLI. This is due to its robustness
against volume conduction effects decreasing the detected connectivity
strength, as was mentioned earlier.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectralConnectivity.html#mne_connectivity.SpectralConnectivity.get_data" title="mne_connectivity.SpectralConnectivity.get_data" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-method"><span class="n">con_pli</span><span class="o">.</span><span class="n">get_data</span></a><span class="p">(</span><span class="s2">&quot;dense&quot;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;PLI&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Sensor 1&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Sensor 2&quot;</span><span class="p">)</span>

<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectralConnectivity.html#mne_connectivity.SpectralConnectivity.get_data" title="mne_connectivity.SpectralConnectivity.get_data" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-method"><span class="n">con_wpli</span><span class="o">.</span><span class="n">get_data</span></a><span class="p">(</span><span class="s2">&quot;dense&quot;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;wPLI&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Sensor 2&quot;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/image_api.html#matplotlib.image.AxesImage" title="matplotlib.image.AxesImage" class="sphx-glr-backref-module-matplotlib-image sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">im</span></a> <span class="o">=</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><a href="../generated/mne_connectivity.SpectralConnectivity.html#mne_connectivity.SpectralConnectivity.get_data" title="mne_connectivity.SpectralConnectivity.get_data" class="sphx-glr-backref-module-mne_connectivity sphx-glr-backref-type-py-method"><span class="n">con_dpli</span><span class="o">.</span><span class="n">get_data</span></a><span class="p">(</span><span class="s2">&quot;dense&quot;</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;dPLI&quot;</span><span class="p">)</span>
<a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Sensor 2&quot;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.colorbar.html#matplotlib.figure.Figure.colorbar" title="matplotlib.figure.Figure.colorbar" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-method"><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span></a><span class="p">(</span><a href="https://matplotlib.org/stable/api/image_api.html#matplotlib.image.AxesImage" title="matplotlib.image.AxesImage" class="sphx-glr-backref-module-matplotlib-image sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">im</span></a><span class="p">,</span> <a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a><span class="o">=</span><a href="https://numpy.org/devdocs/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axs</span></a><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../_images/sphx_glr_dpli_wpli_pli_005.png" srcset="../_images/sphx_glr_dpli_wpli_pli_005.png" alt="PLI, wPLI, dPLI" class = "sphx-glr-single-img"/></section>
<section id="conclusions">
<h2>Conclusions<a class="headerlink" href="#conclusions" title="Link to this heading">#</a></h2>
<p>Both wPLI and dPLI are extensions upon the original PLI method, and provide
complementary information about underlying connectivity.</p>
<ul class="simple">
<li><p>To identify the presence of an underlying phase relationship, wPLI is the
method of choice for most researchers as it provides an improvement in
robustness over the original PLI method</p></li>
<li><p>To know the directionality of the connectivity identified by wPLI, dPLI
should be used</p></li>
</ul>
<p>Ultimately, these methods work great together, providing a comprehensive
estimate of phase-based connectivity.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<div class="docutils container" id="id10">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-stametal2007" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id5">2</a>)</span>
<p>Cornelis J. Stam, Guido Nolte, and Andreas Daffertshofer. Phase lag index: assessment of functional connectivity from multi channel EEG and MEG with diminished bias from common sources. <em>Human Brain Mapping</em>, 28(11):1178–1193, 2007. <a class="reference external" href="https://doi.org/10.1002/hbm.20346">doi:10.1002/hbm.20346</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-vincketal2011" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id4">2</a>,<a role="doc-backlink" href="#id6">3</a>,<a role="doc-backlink" href="#id8">4</a>,<a role="doc-backlink" href="#id9">5</a>)</span>
<p>Martin Vinck, Robert Oostenveld, Marijn van Wingerden, Franscesco Battaglia, and Cyriel M.A. Pennartz. An improved index of phase-synchronization for electrophysiological data in the presence of volume-conduction, noise and sample-size bias. <em>NeuroImage</em>, 55(4):1548–1565, 2011. <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2011.01.055">doi:10.1016/j.neuroimage.2011.01.055</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-stametal2012" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id3">1</a>,<a role="doc-backlink" href="#id7">2</a>)</span>
<p>C. J. Stam and E. C. W. van Straaten. Go with the flow: use of a directed phase lag index (dpli) to characterize patterns of phase relations in a large-scale model of brain dynamics. <em>NeuroImage</em>, 62(3):1415–1428, Sep 2012. <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2012.05.050">doi:10.1016/j.neuroimage.2012.05.050</a>.</p>
</aside>
</aside>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 11.606 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-dpli-wpli-pli-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/c0e8d2c9253a079b7687e8664830e542/dpli_wpli_pli.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">dpli_wpli_pli.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/51b0c8a68236345d60ceb7c4dd05321f/dpli_wpli_pli.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">dpli_wpli_pli.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/b5626e9a9c504cb943b32de3dd6197c9/dpli_wpli_pli.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">dpli_wpli_pli.zip</span></code></a></p>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Examples</p>
      </div>
    </a>
    <a class="right-next"
       href="compare_connectivity_over_time_over_trial.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Comparing spectral connectivity computed over time or over trials</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#background">Background</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#capturing-leading-lagging-phase-relationships-with-dpli">Capturing Leading/Lagging Phase Relationships with dPLI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#robustness-to-outliers-and-noise-with-wpli">Robustness to Outliers and Noise with wPLI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#demo-on-meg-data">Demo On MEG Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusions">Conclusions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2021-2025, MNE Developers. Last updated on 2025-08-11.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>